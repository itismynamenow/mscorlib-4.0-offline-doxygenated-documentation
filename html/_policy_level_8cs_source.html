<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mscorlib(4.0.0.0) offline documentation: System.Security.Policy/PolicyLevel.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mscorlib(4.0.0.0) offline documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_policy_level_8cs_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PolicyLevel.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_policy_level_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_collections.html">Collections</a>;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_i_o.html">IO</a>;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_runtime.html">Runtime</a>.<a class="code" href="namespace_system_1_1_runtime_1_1_interop_services.html">InteropServices</a>;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_runtime.html">Runtime</a>.<a class="code" href="namespace_system_1_1_runtime_1_1_serialization.html">Serialization</a>;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_security.html">Security</a>.<a class="code" href="namespace_system_1_1_security_1_1_permissions.html">Permissions</a>;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_security.html">Security</a>.<a class="code" href="namespace_system_1_1_security_1_1_util.html">Util</a>;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_text.html">Text</a>;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_threading.html">Threading</a>;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_system_1_1_security_1_1_policy.html">System.Security.Policy</a></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    [<a class="code" href="namespace_system_1_1_reflection.html#ada38d588af8789f8647e82c4b04f0cfca33909597338639745b2d76081beeb48b">Serializable</a>]</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    [ComVisible(<span class="keyword">true</span>)]</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html">   15</a></span>&#160;    <span class="keyword">public</span> sealed <span class="keyword">class </span><a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html">PolicyLevel</a></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> m_fullTrustAssemblies;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> m_namedPermissionSets;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html">CodeGroup</a> m_rootCodeGroup;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> m_label;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        [OptionalField(VersionAdded = 2)]</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a> m_type;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">ConfigId</a> m_configId;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_useDefaultCodeGroupsOnReset;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_generateQuickCacheOnLoad;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_caching;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_throwOnLoadError;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_system_1_1_text_1_1_encoding.html">Encoding</a> m_encoding;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_loaded;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> m_permSetElement;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> m_path;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">object</span> s_InternalSyncObject;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">string</span>[] s_reservedNamedPermissionSets;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span>[] EcmaFullTrustAssemblies;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span>[] MicrosoftFullTrustAssemblies;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">object</span> InternalSyncObject</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keywordflow">if</span> (s_InternalSyncObject == <span class="keyword">null</span>)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                    <span class="keywordtype">object</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804">value</a> = <span class="keyword">new</span> object();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                    <a class="code" href="class_system_1_1_threading_1_1_interlocked.html">Interlocked</a>.<a class="code" href="class_system_1_1_threading_1_1_interlocked.html#a3df013d4fa027453ad9b618a3337d222">CompareExchange</a>(ref s_InternalSyncObject, <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804">value</a>, <span class="keyword">null</span>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                <span class="keywordflow">return</span> s_InternalSyncObject;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">   70</a></span>&#160;        {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">if</span> (m_label == <span class="keyword">null</span>)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    m_label = DeriveLabelFromType();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordflow">return</span> m_label;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        [ComVisible(<span class="keyword">false</span>)]</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a> <a class="code" href="class_system_1_1_type.html">Type</a></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ae3f83b98402a703771e6cb093271dbf7">   85</a></span>&#160;        {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="keywordflow">return</span> m_type;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">internal</span> <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">ConfigId</a> <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">ConfigId</a> =&gt; m_configId;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">internal</span> <span class="keywordtype">string</span> <a class="code" href="class_system_1_1_i_o_1_1_path.html">Path</a> =&gt; m_path;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#aea4065ac888575ab6a40d4ca27775482">StoreLocation</a></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#aea4065ac888575ab6a40d4ca27775482">   99</a></span>&#160;        {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            [SecuritySafeCritical]</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            [<a class="code" href="class_system_1_1_security_1_1_permissions_1_1_security_permission.html">SecurityPermission</a>(<a class="code" href="namespace_system_1_1_security_1_1_permissions.html#ab37427d2235868b0c64804ad630baa72">SecurityAction</a>.Demand, Flags = <a class="code" href="namespace_system_1_1_security_1_1_permissions.html#a72a0c66eedeb26a4e728464bf13ec46e">SecurityPermissionFlag</a>.ControlPolicy)]</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">return</span> GetLocationFromType(m_type);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html">CodeGroup</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#abd80e2f17d8263ed14dfc58c202973e9">RootCodeGroup</a></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#abd80e2f17d8263ed14dfc58c202973e9">  112</a></span>&#160;        {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            [SecuritySafeCritical]</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                CheckLoaded();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">return</span> m_rootCodeGroup;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            [SecuritySafeCritical]</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">set</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804">value</a> == <span class="keyword">null</span>)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;RootCodeGroup&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                CheckLoaded();</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                m_rootCodeGroup = <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804">value</a>.Copy();</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keyword">public</span> <a class="code" href="interface_system_1_1_collections_1_1_i_list.html">IList</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a033d21daeef4442029bf33fda54fac91">NamedPermissionSets</a></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a033d21daeef4442029bf33fda54fac91">  134</a></span>&#160;        {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            [SecuritySafeCritical]</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                CheckLoaded();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                LoadAllPermissionSets();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> arrayList = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>(m_namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = m_namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(((<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).Copy());</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="keywordflow">return</span> arrayList;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        [Obsolete(<span class="stringliteral">&quot;Because all GAC assemblies always get full trust, the full trust list is no longer meaningful. You should install any assemblies that are used in security policy in the GAC to ensure they are trusted.&quot;</span>)]</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">public</span> <a class="code" href="interface_system_1_1_collections_1_1_i_list.html">IList</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a399b1c4700ed1f9ab0c8089931bcc211">FullTrustAssemblies</a></div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a399b1c4700ed1f9ab0c8089931bcc211">  154</a></span>&#160;        {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            [SecuritySafeCritical]</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                CheckLoaded();</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>(m_fullTrustAssemblies);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keyword">static</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html">PolicyLevel</a>()</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            s_reservedNamedPermissionSets = <span class="keyword">new</span> <span class="keywordtype">string</span>[7]</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="stringliteral">&quot;FullTrust&quot;</span>,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="stringliteral">&quot;Nothing&quot;</span>,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="stringliteral">&quot;Execution&quot;</span>,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="stringliteral">&quot;SkipVerification&quot;</span>,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="stringliteral">&quot;Internet&quot;</span>,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="stringliteral">&quot;LocalIntranet&quot;</span>,</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="stringliteral">&quot;Everything&quot;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            };</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            EcmaFullTrustAssemblies = <span class="keyword">new</span> <span class="keywordtype">string</span>[9]</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="stringliteral">&quot;mscorlib.resources&quot;</span>,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="stringliteral">&quot;System&quot;</span>,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="stringliteral">&quot;System.resources&quot;</span>,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="stringliteral">&quot;System.Xml&quot;</span>,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="stringliteral">&quot;System.Xml.resources&quot;</span>,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="stringliteral">&quot;System.Windows.Forms&quot;</span>,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="stringliteral">&quot;System.Windows.Forms.resources&quot;</span>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="stringliteral">&quot;System.Data&quot;</span>,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="stringliteral">&quot;System.Data.resources&quot;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            };</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            MicrosoftFullTrustAssemblies = <span class="keyword">new</span> <span class="keywordtype">string</span>[12]</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="stringliteral">&quot;System.Security&quot;</span>,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="stringliteral">&quot;System.Security.resources&quot;</span>,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="stringliteral">&quot;System.Drawing&quot;</span>,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="stringliteral">&quot;System.Drawing.resources&quot;</span>,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="stringliteral">&quot;System.Messaging&quot;</span>,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="stringliteral">&quot;System.Messaging.resources&quot;</span>,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="stringliteral">&quot;System.ServiceProcess&quot;</span>,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="stringliteral">&quot;System.ServiceProcess.resources&quot;</span>,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="stringliteral">&quot;System.DirectoryServices&quot;</span>,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="stringliteral">&quot;System.DirectoryServices.resources&quot;</span>,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="stringliteral">&quot;System.Deployment&quot;</span>,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="stringliteral">&quot;System.Deployment.resources&quot;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            };</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        [OnDeserialized]</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> OnDeserialized(<a class="code" href="struct_system_1_1_runtime_1_1_serialization_1_1_streaming_context.html">StreamingContext</a> ctx)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">if</span> (m_label != <span class="keyword">null</span>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                DeriveTypeFromLabel();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> DeriveTypeFromLabel()</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span> (m_label.Equals(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_User&quot;</span>)))</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                m_type = <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.User;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span> (m_label.Equals(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_Machine&quot;</span>)))</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                m_type = <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Machine;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> (m_label.Equals(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_Enterprise&quot;</span>)))</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                m_type = <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Enterprise;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span> (m_label.Equals(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_AppDomain&quot;</span>)))</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                m_type = <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.AppDomain;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Default&quot;</span>));</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> DeriveLabelFromType()</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">switch</span> (m_type)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.User:</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="keywordflow">return</span> Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_User&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Machine:</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">return</span> Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_Machine&quot;</span>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Enterprise:</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">return</span> Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_Enterprise&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.AppDomain:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keywordflow">return</span> Environment.GetResourceString(<span class="stringliteral">&quot;Policy_PL_AppDomain&quot;</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(Environment.GetResourceString(<span class="stringliteral">&quot;Arg_EnumIllegalVal&quot;</span>, (<span class="keywordtype">int</span>)m_type));</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keyword">private</span> PolicyLevel()</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keyword">internal</span> PolicyLevel(<a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a> type)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            : this(type, GetLocationFromType(type))</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keyword">internal</span> PolicyLevel(<a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a> type, <span class="keywordtype">string</span> path)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            : this(type, path, <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">ConfigId</a>.<a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807ba6adf97f83acf6453d4a6a4b1070f3754">None</a>)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">internal</span> PolicyLevel(<a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a> type, <span class="keywordtype">string</span> path, ConfigId configId)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            m_type = type;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            m_path = path;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            m_loaded = (path == <span class="keyword">null</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">if</span> (m_path == <span class="keyword">null</span>)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                m_rootCodeGroup = CreateDefaultAllGroup();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                SetFactoryPermissionSets();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                SetDefaultFullTrustAssemblies();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            m_configId = configId;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">string</span> GetLocationFromType(<a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a> type)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">switch</span> (type)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.User:</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.UserDirectory + <span class="stringliteral">&quot;security.config&quot;</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Machine:</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.MachineDirectory + <span class="stringliteral">&quot;security.config&quot;</span>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Enterprise:</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.MachineDirectory + <span class="stringliteral">&quot;enterprisesec.config&quot;</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        [Obsolete(<span class="stringliteral">&quot;AppDomain policy levels are obsolete and will be removed in a future release of the .NET Framework. See http://go.microsoft.com/fwlink/?LinkID=155570 for more information.&quot;</span>)]</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ac80702663cd363d0ca3e38a631513f8a">  304</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html">PolicyLevel</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ac80702663cd363d0ca3e38a631513f8a">CreateAppDomainLevel</a>()</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html">PolicyLevel</a>(<a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.AppDomain);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ad21d8492577ca10bfcceeacf743a99ce">  314</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html">CodeGroup</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ad21d8492577ca10bfcceeacf743a99ce">ResolveMatchingCodeGroups</a>(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_evidence.html">Evidence</a> evidence)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> (evidence == <span class="keyword">null</span>)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;evidence&quot;</span>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#abd80e2f17d8263ed14dfc58c202973e9">RootCodeGroup</a>.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a125ac26313cbc430328e1eb0e4b18647">ResolveMatchingCodeGroups</a>(evidence);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        [Obsolete(<span class="stringliteral">&quot;Because all GAC assemblies always get full trust, the full trust list is no longer meaningful. You should install any assemblies that are used in security policy in the GAC to ensure they are trusted.&quot;</span>)]</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af59c5fd5007be56e941733b789efcbc3">  328</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af59c5fd5007be56e941733b789efcbc3">AddFullTrustAssembly</a>(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html">StrongName</a> sn)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordflow">if</span> (sn == <span class="keyword">null</span>)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;sn&quot;</span>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af59c5fd5007be56e941733b789efcbc3">AddFullTrustAssembly</a>(<span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>(sn.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a45faeec13ad9932786d6560c58d3624b">PublicKey</a>, sn.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a3710d8ae95a33b4a99b81f7b8af14062">Name</a>, sn.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a42f6643709acd58b896d36d12d3ebbea">Version</a>));</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        [Obsolete(<span class="stringliteral">&quot;Because all GAC assemblies always get full trust, the full trust list is no longer meaningful. You should install any assemblies that are used in security policy in the GAC to ensure they are trusted.&quot;</span>)]</div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a48b602fd5efbc171aaa3867cf124b9b9">  343</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a48b602fd5efbc171aaa3867cf124b9b9">AddFullTrustAssembly</a>(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a> snMC)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">if</span> (snMC == <span class="keyword">null</span>)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;snMC&quot;</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            CheckLoaded();</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = m_fullTrustAssemblies.GetEnumerator();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">if</span> (((<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).Equals(snMC))</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_AssemblyAlreadyFullTrust&quot;</span>));</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            lock (m_fullTrustAssemblies)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                m_fullTrustAssemblies.Add(snMC);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        [Obsolete(<span class="stringliteral">&quot;Because all GAC assemblies always get full trust, the full trust list is no longer meaningful. You should install any assemblies that are used in security policy in the GAC to ensure they are trusted.&quot;</span>)]</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a95de9d8568442bf68b614256df0d77ee">  369</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a95de9d8568442bf68b614256df0d77ee">RemoveFullTrustAssembly</a>(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html">StrongName</a> sn)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> (sn == <span class="keyword">null</span>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;assembly&quot;</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a95de9d8568442bf68b614256df0d77ee">RemoveFullTrustAssembly</a>(<span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>(sn.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a45faeec13ad9932786d6560c58d3624b">PublicKey</a>, sn.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a3710d8ae95a33b4a99b81f7b8af14062">Name</a>, sn.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a42f6643709acd58b896d36d12d3ebbea">Version</a>));</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        [Obsolete(<span class="stringliteral">&quot;Because all GAC assemblies always get full trust, the full trust list is no longer meaningful. You should install any assemblies that are used in security policy in the GAC to ensure they are trusted.&quot;</span>)]</div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af2d073f18651959c8a45246596ee497f">  384</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af2d073f18651959c8a45246596ee497f">RemoveFullTrustAssembly</a>(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a> snMC)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">if</span> (snMC == <span class="keyword">null</span>)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;snMC&quot;</span>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            CheckLoaded();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordtype">object</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637abe8f80182e0c983916da7338c2c1c040">obj</a> = <span class="keyword">null</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = m_fullTrustAssemblies.GetEnumerator();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <span class="keywordflow">if</span> (((<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).Equals(snMC))</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637abe8f80182e0c983916da7338c2c1c040">obj</a> = enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637abe8f80182e0c983916da7338c2c1c040">obj</a> == <span class="keyword">null</span>)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_AssemblyNotFullTrust&quot;</span>));</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            lock (m_fullTrustAssemblies)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                m_fullTrustAssemblies.Remove(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637abe8f80182e0c983916da7338c2c1c040">obj</a>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a2d9998fd9bb3162cbf2f2d63db8829b5">  416</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a2d9998fd9bb3162cbf2f2d63db8829b5">AddNamedPermissionSet</a>(<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> permSet)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> (permSet == <span class="keyword">null</span>)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;permSet&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            CheckLoaded();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            LoadAllPermissionSets();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            lock (<span class="keyword">this</span>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = m_namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    <span class="keywordflow">if</span> (((<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).Name.Equals(permSet.<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html#a6448392289ef8a21d97da082dfe8b407">Name</a>))</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_DuplicateName&quot;</span>));</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> namedPermissionSet = (<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)permSet.<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html#a30b077d033804444441581161fa787c6">Copy</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                namedPermissionSet.IgnoreTypeLoadFailures = <span class="keyword">true</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                m_namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(namedPermissionSet);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a82b4f0b7537ccf39f114476871539abb">  445</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a82b4f0b7537ccf39f114476871539abb">RemoveNamedPermissionSet</a>(<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> permSet)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">if</span> (permSet == <span class="keyword">null</span>)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;permSet&quot;</span>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a82b4f0b7537ccf39f114476871539abb">RemoveNamedPermissionSet</a>(permSet.<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html#a6448392289ef8a21d97da082dfe8b407">Name</a>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8b724f661a8e20d4f1caadf32b711c64">  460</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8b724f661a8e20d4f1caadf32b711c64">RemoveNamedPermissionSet</a>(<span class="keywordtype">string</span> name)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a> == <span class="keyword">null</span>)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            CheckLoaded();</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            LoadAllPermissionSets();</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordtype">int</span> num = -1;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s_reservedNamedPermissionSets.Length; i++)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="keywordflow">if</span> (s_reservedNamedPermissionSets[i].Equals(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>))</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_ReservedNPMS&quot;</span>, <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>));</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> namedPermissionSets = m_namedPermissionSets;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a>; j++)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keywordflow">if</span> (((<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)namedPermissionSets[j]).Name.Equals(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>))</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    num = j;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (num == -1)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_NoNPMS&quot;</span>));</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> arrayList = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(m_rootCodeGroup);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a>; k++)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html">CodeGroup</a> codeGroup = (<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html">CodeGroup</a>)arrayList[k];</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="keywordflow">if</span> (codeGroup.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a93cc42ed19b1c103362dd45b61eebeda">PermissionSetName</a> != <span class="keyword">null</span> &amp;&amp; codeGroup.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a93cc42ed19b1c103362dd45b61eebeda">PermissionSetName</a>.Equals(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>))</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_NPMSInUse&quot;</span>, <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>));</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = codeGroup.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a6eb495d447218aad835b60c16ff91a65">Children</a>.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerable.html#a254796d00735d72da46328daa0fa52cd">GetEnumerator</a>();</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">if</span> (enumerator != <span class="keyword">null</span>)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> result = (<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)namedPermissionSets[num];</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a8c936196f485ce7fb2d89baf324a6369">RemoveAt</a>(num);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a78f2d70740273172f5632161def9c66e">  519</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a78f2d70740273172f5632161def9c66e">ChangeNamedPermissionSet</a>(<span class="keywordtype">string</span> name, <a class="code" href="class_system_1_1_security_1_1_permission_set.html">PermissionSet</a> pSet)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a> == <span class="keyword">null</span>)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">if</span> (pSet == <span class="keyword">null</span>)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;pSet&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s_reservedNamedPermissionSets.Length; i++)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                <span class="keywordflow">if</span> (s_reservedNamedPermissionSets[i].Equals(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>))</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_ReservedNPMS&quot;</span>, <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>));</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> namedPermissionSetInternal = GetNamedPermissionSetInternal(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span> (namedPermissionSetInternal == <span class="keyword">null</span>)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_NoNPMS&quot;</span>));</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> result = (<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)namedPermissionSetInternal.<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html#a30b077d033804444441581161fa787c6">Copy</a>();</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            namedPermissionSetInternal.Reset();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            namedPermissionSetInternal.SetUnrestricted(pSet.<a class="code" href="class_system_1_1_security_1_1_permission_set.html#a3727f9e512d890f2ea741586d49b850c">IsUnrestricted</a>());</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = pSet.<a class="code" href="class_system_1_1_security_1_1_permission_set.html#a9f013896aacd59ffdf99d9b2e0911f17">GetEnumerator</a>();</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                namedPermissionSetInternal.<a class="code" href="class_system_1_1_security_1_1_permission_set.html#a1147e6c2840aa84c1c84e7358d8140da">SetPermission</a>(((<a class="code" href="interface_system_1_1_security_1_1_i_permission.html">IPermission</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).Copy());</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordflow">if</span> (pSet is <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                namedPermissionSetInternal.<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html#a060f6cd3c7540bcc8bda9060fea422c5">Description</a> = ((<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)pSet).Description;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#aca2cbb087803debaba70a7e1c7710967">  561</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#aca2cbb087803debaba70a7e1c7710967">GetNamedPermissionSet</a>(<span class="keywordtype">string</span> name)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a> == <span class="keyword">null</span>)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a> namedPermissionSetInternal = GetNamedPermissionSetInternal(<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> (namedPermissionSetInternal != <span class="keyword">null</span>)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>(namedPermissionSetInternal);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ad70e34e5aebdd445f51e1e6d480832ff">  578</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ad70e34e5aebdd445f51e1e6d480832ff">Recover</a>()</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">if</span> (m_configId == <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">ConfigId</a>.None)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_exception.html">PolicyException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Policy_RecoverNotFileBased&quot;</span>));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            lock (<span class="keyword">this</span>)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.RecoverData(m_configId))</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_exception.html">PolicyException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Policy_RecoverNoConfigFile&quot;</span>));</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                m_loaded = <span class="keyword">false</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                m_rootCodeGroup = <span class="keyword">null</span>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                m_namedPermissionSets = <span class="keyword">null</span>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                m_fullTrustAssemblies = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab0f410fac6284b2de7319065c6bb46ff">  599</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab0f410fac6284b2de7319065c6bb46ff">Reset</a>()</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            SetDefault();</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af12ba222b31f98e0e92f94e04b105252">  610</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_statement.html">PolicyStatement</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af12ba222b31f98e0e92f94e04b105252">Resolve</a>(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_evidence.html">Evidence</a> evidence)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af12ba222b31f98e0e92f94e04b105252">Resolve</a>(evidence, 0, <span class="keyword">null</span>);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        [SecuritySafeCritical]</div><div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">  618</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">ToXml</a>()</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            CheckLoaded();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            LoadAllPermissionSets();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>(<span class="stringliteral">&quot;PolicyLevel&quot;</span>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            securityElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad48d7fbe45e318f8d33bcab6608fa812">AddAttribute</a>(<span class="stringliteral">&quot;version&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> hashtable = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a>();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            lock (<span class="keyword">this</span>)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement2 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>(<span class="stringliteral">&quot;NamedPermissionSets&quot;</span>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = m_namedPermissionSets.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    securityElement2.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">AddChild</a>(NormalizeClassDeep(((<a class="code" href="class_system_1_1_security_1_1_named_permission_set.html">NamedPermissionSet</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).ToXml(), hashtable));</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> child = NormalizeClassDeep(m_rootCodeGroup.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a1485a3a41b5a86b600fd5dff20459bac">ToXml</a>(<span class="keyword">this</span>), hashtable);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement3 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>(<span class="stringliteral">&quot;FullTrustAssemblies&quot;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                enumerator = m_fullTrustAssemblies.GetEnumerator();</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    securityElement3.AddChild(NormalizeClassDeep(((<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).ToXml(), hashtable));</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement4 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>(<span class="stringliteral">&quot;SecurityClasses&quot;</span>);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_dictionary_enumerator.html">IDictionaryEnumerator</a> enumerator2 = hashtable.GetEnumerator();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="keywordflow">while</span> (enumerator2.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement5 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>(<span class="stringliteral">&quot;SecurityClass&quot;</span>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    securityElement5.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad48d7fbe45e318f8d33bcab6608fa812">AddAttribute</a>(<span class="stringliteral">&quot;Name&quot;</span>, (<span class="keywordtype">string</span>)enumerator2.<a class="code" href="interface_system_1_1_collections_1_1_i_dictionary_enumerator.html#a00ea809508fa82bfdb2c06f3cece42ee">Value</a>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    securityElement5.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad48d7fbe45e318f8d33bcab6608fa812">AddAttribute</a>(<span class="stringliteral">&quot;Description&quot;</span>, (<span class="keywordtype">string</span>)enumerator2.<a class="code" href="interface_system_1_1_collections_1_1_i_dictionary_enumerator.html#aaab78842b39cbe2310cf3b3f21ee9560">Key</a>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    securityElement4.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">AddChild</a>(securityElement5);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                securityElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">AddChild</a>(securityElement4);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                securityElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">AddChild</a>(securityElement2);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                securityElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">AddChild</a>(child);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                securityElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">AddChild</a>(securityElement3);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <span class="keywordflow">return</span> securityElement;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8d4479ae855aa13452546dbc6350ba76">  661</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8d4479ae855aa13452546dbc6350ba76">FromXml</a>(<a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> e)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordflow">if</span> (e == <span class="keyword">null</span>)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_null_exception.html">ArgumentNullException</a>(<span class="stringliteral">&quot;e&quot;</span>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            lock (<span class="keyword">this</span>)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> arrayList = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement = e.<a class="code" href="class_system_1_1_security_1_1_security_element.html#a3829be72382aafa67029ed718e66d838">SearchForChildByTag</a>(<span class="stringliteral">&quot;SecurityClasses&quot;</span>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> hashtable;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keywordflow">if</span> (securityElement != <span class="keyword">null</span>)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    hashtable = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a>();</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = securityElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad24193db4883540cf336dcec27d9aea2">Children</a>.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement2 = (<a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                        if (securityElement2.<a class="code" href="class_system_1_1_security_1_1_security_element.html#a4449f33ab4e2a05ca30b6cec08d04dfa">Tag</a>.Equals(<span class="stringliteral">&quot;SecurityClass&quot;</span>))</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                            <span class="keywordtype">string</span> text = securityElement2.Attribute(<span class="stringliteral">&quot;Name&quot;</span>);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                            <span class="keywordtype">string</span> text2 = securityElement2.Attribute(<span class="stringliteral">&quot;Description&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                            <span class="keywordflow">if</span> (text != <span class="keyword">null</span> &amp;&amp; text2 != <span class="keyword">null</span>)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                            {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                hashtable.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a0860df05ec1cf7b9f6650d9de653c8dd">Add</a>(text, text2);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                        }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    hashtable = <span class="keyword">null</span>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement3 = e.<a class="code" href="class_system_1_1_security_1_1_security_element.html#a3829be72382aafa67029ed718e66d838">SearchForChildByTag</a>(<span class="stringliteral">&quot;FullTrustAssemblies&quot;</span>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <span class="keywordflow">if</span> (securityElement3 != <span class="keyword">null</span> &amp;&amp; securityElement3.InternalChildren != <span class="keyword">null</span>)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    <span class="keywordtype">string</span> assemblyQualifiedName = typeof(<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>).AssemblyQualifiedName;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator2 = securityElement3.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad24193db4883540cf336dcec27d9aea2">Children</a>.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <span class="keywordflow">while</span> (enumerator2.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                        <a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a> strongNameMembershipCondition = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">StrongNameMembershipCondition</a>();</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                        strongNameMembershipCondition.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html#ad60f746daf02356abb71d620100f728f">FromXml</a>((<a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>)enumerator2.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                        arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(strongNameMembershipCondition);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                m_fullTrustAssemblies = arrayList;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> arrayList2 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement4 = e.<a class="code" href="class_system_1_1_security_1_1_security_element.html#a3829be72382aafa67029ed718e66d838">SearchForChildByTag</a>(<span class="stringliteral">&quot;NamedPermissionSets&quot;</span>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement5 = <span class="keyword">null</span>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keywordflow">if</span> (securityElement4 != <span class="keyword">null</span> &amp;&amp; securityElement4.InternalChildren != <span class="keyword">null</span>)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                    securityElement5 = UnnormalizeClassDeep(securityElement4, hashtable);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    <span class="keywordtype">string</span>[] <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637af1f713c9e000f5d3f280adbd124df4f5">array</a> = s_reservedNamedPermissionSets;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a> <span class="keywordflow">in</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637af1f713c9e000f5d3f280adbd124df4f5">array</a>)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                        FindElement(securityElement5, <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <span class="keywordflow">if</span> (securityElement5 == <span class="keyword">null</span>)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    securityElement5 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a>(<span class="stringliteral">&quot;NamedPermissionSets&quot;</span>);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.FullTrust);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.Everything);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.SkipVerification);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.Execution);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.Nothing);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.Internet);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                arrayList2.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(<a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.LocalIntranet);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordflow">foreach</span> (<a class="code" href="class_system_1_1_security_1_1_permission_set.html">PermissionSet</a> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a447b7147e84be512208dcc0995d67ebc">item</a> <span class="keywordflow">in</span> arrayList2)</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a447b7147e84be512208dcc0995d67ebc">item</a>.IgnoreTypeLoadFailures = <span class="keyword">true</span>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                m_namedPermissionSets = arrayList2;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                m_permSetElement = securityElement5;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_security_element.html">SecurityElement</a> securityElement6 = e.<a class="code" href="class_system_1_1_security_1_1_security_element.html#a3829be72382aafa67029ed718e66d838">SearchForChildByTag</a>(<span class="stringliteral">&quot;CodeGroup&quot;</span>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">if</span> (securityElement6 == <span class="keyword">null</span>)</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_InvalidXMLElement&quot;</span>, <span class="stringliteral">&quot;CodeGroup&quot;</span>, GetType().<a class="code" href="namespace_system.html#a3468295287d2f03b02e4f473f0c4c310ae309e678d77a80e722dd1695137a5a21">FullName</a>));</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                }</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html">CodeGroup</a> codeGroup = <a class="code" href="class_system_1_1_security_1_1_util_1_1_x_m_l_util.html">XMLUtil</a>.<a class="code" href="class_system_1_1_security_1_1_util_1_1_x_m_l_util.html#aa9fb98151b6592a6c58c2e5ded8b69ec">CreateCodeGroup</a>(UnnormalizeClassDeep(securityElement6, hashtable));</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="keywordflow">if</span> (codeGroup == <span class="keyword">null</span>)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_system_1_1_argument_exception.html">ArgumentException</a>(<a class="code" href="class_system_1_1_environment.html">Environment</a>.GetResourceString(<span class="stringliteral">&quot;Argument_InvalidXMLElement&quot;</span>, <span class="stringliteral">&quot;CodeGroup&quot;</span>, GetType().<a class="code" href="namespace_system.html#a3468295287d2f03b02e4f473f0c4c310ae309e678d77a80e722dd1695137a5a21">FullName</a>));</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                codeGroup.<a class="code" href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a772b7a61e77f428cd796ccf6079ed79b">FromXml</a>(securityElement6, <span class="keyword">this</span>);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                m_rootCodeGroup = codeGroup;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <a class="code" href="class_system_1_1_security_1_1_permission_set.html">PermissionSet</a> GetBuiltInSet(<span class="keywordtype">string</span> name)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(name))</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>.Equals(<span class="stringliteral">&quot;FullTrust&quot;</span>))</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_system_1_1_security_1_1_built_in_permission_sets.html">BuiltInPermissionSets</a>.FullTrust;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>.Equals(<span class="stringliteral">&quot;Nothing&quot;</span>))</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                <span class="keywordflow">return</span> BuiltInPermissionSets.Nothing;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">if</span> (name.Equals(<span class="stringliteral">&quot;Execution&quot;</span>))</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="keywordflow">return</span> BuiltInPermissionSets.Execution;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>.Equals(<span class="stringliteral">&quot;SkipVerification&quot;</span>))</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keywordflow">return</span> BuiltInPermissionSets.SkipVerification;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>.Equals(<span class="stringliteral">&quot;Internet&quot;</span>))</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="keywordflow">return</span> BuiltInPermissionSets.Internet;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>.Equals(<span class="stringliteral">&quot;LocalIntranet&quot;</span>))</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <span class="keywordflow">return</span> BuiltInPermissionSets.LocalIntranet;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keyword">internal</span> NamedPermissionSet GetNamedPermissionSetInternal(<span class="keywordtype">string</span> name)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            CheckLoaded();</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            lock (InternalSyncObject)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <span class="keywordflow">foreach</span> (NamedPermissionSet namedPermissionSet3 <span class="keywordflow">in</span> m_namedPermissionSets)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    <span class="keywordflow">if</span> (namedPermissionSet3.Name.Equals(name))</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                        <span class="keywordflow">return</span> namedPermissionSet3;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <span class="keywordflow">if</span> (m_permSetElement != <span class="keyword">null</span>)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    SecurityElement securityElement = FindElement(m_permSetElement, name);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="keywordflow">if</span> (securityElement != <span class="keyword">null</span>)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        NamedPermissionSet namedPermissionSet2 = <span class="keyword">new</span> NamedPermissionSet();</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        namedPermissionSet2.Name = <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">name</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                        m_namedPermissionSets.Add(namedPermissionSet2);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                            namedPermissionSet2.FromXml(securityElement, allowInternalOnly: <span class="keyword">false</span>, ignoreTypeLoadFailures: <span class="keyword">true</span>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        <span class="keywordflow">catch</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                        {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                            m_namedPermissionSets.Remove(namedPermissionSet2);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        <span class="keywordflow">if</span> (namedPermissionSet2.Name != <span class="keyword">null</span>)</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                        {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                            <span class="keywordflow">return</span> namedPermissionSet2;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                        }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        m_namedPermissionSets.Remove(namedPermissionSet2);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keyword">internal</span> PolicyStatement <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af12ba222b31f98e0e92f94e04b105252">Resolve</a>(Evidence evidence, <span class="keywordtype">int</span> count, <span class="keywordtype">byte</span>[] serializedEvidence)</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordflow">if</span> (evidence == <span class="keyword">null</span>)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="stringliteral">&quot;evidence&quot;</span>);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            }</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            PolicyStatement policyStatement = <span class="keyword">null</span>;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">if</span> (serializedEvidence != <span class="keyword">null</span>)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                policyStatement = CheckCache(count, serializedEvidence);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">if</span> (policyStatement == <span class="keyword">null</span>)</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                CheckLoaded();</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordtype">bool</span> allConst;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keywordflow">if</span> (m_fullTrustAssemblies != <span class="keyword">null</span> &amp;&amp; IsFullTrustAssembly(m_fullTrustAssemblies, evidence))</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    policyStatement = <span class="keyword">new</span> PolicyStatement(<span class="keyword">new</span> PermissionSet(fUnrestricted: <span class="keyword">true</span>), <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ac8244eac6f2b5abb898a0cf277de2ad9">PolicyStatementAttribute</a>.Nothing);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    allConst = <span class="keyword">true</span>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> arrayList = GenericResolve(evidence, out allConst);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    policyStatement = <span class="keyword">new</span> PolicyStatement();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    policyStatement.PermissionSet = <span class="keyword">null</span>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                        PolicyStatement policy = ((CodeGroupStackFrame)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>).policy;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        <span class="keywordflow">if</span> (policy != <span class="keyword">null</span>)</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                            policyStatement.GetPermissionSetNoCopy().InplaceUnion(policy.GetPermissionSetNoCopy());</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                            policyStatement.Attributes |= policy.Attributes;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            <span class="keywordflow">if</span> (policy.HasDependentEvidence)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                            {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                <span class="keywordflow">foreach</span> (IDelayEvaluatedEvidence item <span class="keywordflow">in</span> policy.DependentEvidence)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                    <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a447b7147e84be512208dcc0995d67ebc">item</a>.MarkUsed();</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                            }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                        }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                    }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="keywordflow">if</span> (allConst)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    Cache(count, evidence.RawSerialize(), policyStatement);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="keywordflow">return</span> policyStatement;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> CheckLoaded()</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="keywordflow">if</span> (!m_loaded)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                lock (InternalSyncObject)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    <span class="keywordflow">if</span> (!m_loaded)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        LoadPolicyLevel();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">byte</span>[] ReadFile(<span class="keywordtype">string</span> fileName)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="keyword">using</span> (<a class="code" href="class_system_1_1_i_o_1_1_file_stream.html">FileStream</a> fileStream = <span class="keyword">new</span> <a class="code" href="class_system_1_1_i_o_1_1_file_stream.html">FileStream</a>(fileName, <a class="code" href="namespace_system_1_1_i_o.html#a806eadc224c3dfd0d87ac587bb376184">FileMode</a>.Open, <a class="code" href="namespace_system_1_1_i_o.html#a482862b3c03fa32a3249d7904b91d586">FileAccess</a>.Read))</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <span class="keywordtype">int</span> num = (int)fileStream.<a class="code" href="class_system_1_1_i_o_1_1_file_stream.html#a043afb181ae153dee40036779a96e38e">Length</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keywordtype">byte</span>[] array = <span class="keyword">new</span> <span class="keywordtype">byte</span>[num];</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                num = fileStream.<a class="code" href="class_system_1_1_i_o_1_1_file_stream.html#add32fedfe35b2c0212214fcac8cf4398">Read</a>(array, 0, num);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                fileStream.<a class="code" href="class_system_1_1_i_o_1_1_stream.html#a6336b2150d4e31e34911d429c690757f">Close</a>();</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637af1f713c9e000f5d3f280adbd124df4f5">array</a>;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> LoadPolicyLevel()</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            Exception ex = <span class="keyword">null</span>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            CodeAccessPermission.Assert(allPossible: <span class="keyword">true</span>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_system_1_1_i_o_1_1_file.html">File</a>.InternalExists(m_path))</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                <a class="code" href="class_system_1_1_text_1_1_encoding.html">Encoding</a> uTF = <a class="code" href="class_system_1_1_text_1_1_encoding.html">Encoding</a>.<a class="code" href="class_system_1_1_text_1_1_encoding.html#a512fe96ac1087a83ef66007170c7769f">UTF8</a>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                SecurityElement securityElement;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    <span class="keywordtype">string</span> @<span class="keywordtype">string</span> = uTF.<a class="code" href="class_system_1_1_text_1_1_encoding.html#aede7f91d315dea0edff82c851f79d0e1">GetString</a>(ReadFile(m_path));</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    securityElement = SecurityElement.FromString(@<span class="keywordtype">string</span>);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="keywordflow">catch</span> (Exception ex2)</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    <span class="keywordtype">string</span> text = <span class="keywordtype">string</span>.IsNullOrEmpty(ex2.Message) ? ex2.GetType().AssemblyQualifiedName : ex2.Message;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParseEx&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>, text));</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                    <span class="keywordflow">goto</span> IL_01bd;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="keywordflow">if</span> (securityElement == <span class="keyword">null</span>)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParse&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>));</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    SecurityElement securityElement2 = securityElement.SearchForChildByTag(<span class="stringliteral">&quot;mscorlib&quot;</span>);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">if</span> (securityElement2 == <span class="keyword">null</span>)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    {</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParse&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>));</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    }</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        SecurityElement securityElement3 = securityElement2.SearchForChildByTag(<span class="stringliteral">&quot;security&quot;</span>);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                        <span class="keywordflow">if</span> (securityElement3 == <span class="keyword">null</span>)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                            ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParse&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>));</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                        }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                            SecurityElement securityElement4 = securityElement3.SearchForChildByTag(<span class="stringliteral">&quot;policy&quot;</span>);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                            <span class="keywordflow">if</span> (securityElement4 == <span class="keyword">null</span>)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                            {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParse&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>));</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                            }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                            {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                SecurityElement securityElement5 = securityElement4.SearchForChildByTag(<span class="stringliteral">&quot;PolicyLevel&quot;</span>);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                <span class="keywordflow">if</span> (securityElement5 != <span class="keyword">null</span>)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                {</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                    <span class="keywordflow">try</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                    {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                        <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8d4479ae855aa13452546dbc6350ba76">FromXml</a>(securityElement5);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                    }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                    <span class="keywordflow">catch</span> (Exception)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                    {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                        ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParse&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>));</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                        <span class="keywordflow">goto</span> IL_01bd;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                    }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                    m_loaded = <span class="keyword">true</span>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                ex = LoadError(Environment.GetResourceString(<span class="stringliteral">&quot;Error_SecurityPolicyFileParse&quot;</span>, <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">Label</a>));</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                            }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                        }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">goto</span> IL_01bd;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            IL_01bd:</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            SetDefault();</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            m_loaded = <span class="keyword">true</span>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">if</span> (ex != <span class="keyword">null</span>)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                <span class="keywordflow">throw</span> ex;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keyword">private</span> Exception LoadError(<span class="keywordtype">string</span> message)</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">if</span> (m_type != 0 &amp;&amp; m_type != <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Machine &amp;&amp; m_type != <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Enterprise)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> ArgumentException(message);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.WriteToEventLog(message);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Cache(<span class="keywordtype">int</span> count, <span class="keywordtype">byte</span>[] serializedEvidence, PolicyStatement policy)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">if</span> (m_configId != 0 &amp;&amp; serializedEvidence != <span class="keyword">null</span>)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                <span class="keywordtype">byte</span>[] data = <span class="keyword">new</span> SecurityDocument(policy.ToXml(<span class="keyword">null</span>, useInternal: <span class="keyword">true</span>)).m_data;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                <a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.AddCacheEntry(m_configId, count, serializedEvidence, data);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keyword">private</span> PolicyStatement CheckCache(<span class="keywordtype">int</span> count, <span class="keywordtype">byte</span>[] serializedEvidence)</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keywordflow">if</span> (m_configId == <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">ConfigId</a>.None)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            }</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <span class="keywordflow">if</span> (serializedEvidence == <span class="keyword">null</span>)</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_system_1_1_security_1_1_util_1_1_config.html">Config</a>.GetCacheEntry(m_configId, count, serializedEvidence, out <span class="keywordtype">byte</span>[] data))</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            PolicyStatement policyStatement = <span class="keyword">new</span> PolicyStatement();</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            SecurityDocument doc = <span class="keyword">new</span> SecurityDocument(data);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            policyStatement.FromXml(doc, 0, <span class="keyword">null</span>, allowInternalOnly: <span class="keyword">true</span>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordflow">return</span> policyStatement;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> IsFullTrustAssembly(<a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> fullTrustAssemblies, Evidence evidence)</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">if</span> (fullTrustAssemblies.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a> == 0)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            }</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="keywordflow">if</span> (evidence != <span class="keyword">null</span>)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                lock (fullTrustAssemblies)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = fullTrustAssemblies.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">GetEnumerator</a>();</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        StrongNameMembershipCondition strongNameMembershipCondition = (StrongNameMembershipCondition)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                        if (strongNameMembershipCondition.Check(evidence))</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                        {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                            <span class="keywordflow">if</span> (Environment.GetCompatibilityFlag(<a class="code" href="namespace_system.html#aa0aef5be110e36c32fb5312a4fdaec1a">CompatibilityFlag</a>.FullTrustListAssembliesInGac))</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                            {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                <span class="keywordflow">if</span> (<span class="keyword">new</span> ZoneMembershipCondition().Check(evidence))</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                                }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                            }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">new</span> GacMembershipCondition().Check(evidence))</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                            {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                            }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keyword">private</span> CodeGroup CreateDefaultAllGroup()</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            UnionCodeGroup unionCodeGroup = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            unionCodeGroup.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;FullTrust&quot;</span>, <span class="keyword">new</span> AllMembershipCondition().<a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">ToXml</a>()), <span class="keyword">this</span>);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            unionCodeGroup.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_AllCode_Name&quot;</span>);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            unionCodeGroup.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_AllCode_DescriptionFullTrust&quot;</span>);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">return</span> unionCodeGroup;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keyword">private</span> CodeGroup CreateDefaultMachinePolicy()</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            UnionCodeGroup unionCodeGroup = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            unionCodeGroup.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;Nothing&quot;</span>, <span class="keyword">new</span> AllMembershipCondition().<a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">ToXml</a>()), <span class="keyword">this</span>);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            unionCodeGroup.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_AllCode_Name&quot;</span>);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            unionCodeGroup.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_AllCode_DescriptionNothing&quot;</span>);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            UnionCodeGroup unionCodeGroup2 = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            unionCodeGroup2.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;FullTrust&quot;</span>, <span class="keyword">new</span> ZoneMembershipCondition(<a class="code" href="namespace_system_1_1_security.html#ace876efc23086dc690af1935e4ed3430">SecurityZone</a>.MyComputer).ToXml()), <span class="keyword">this</span>);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            unionCodeGroup2.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_MyComputer_Name&quot;</span>);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            unionCodeGroup2.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_MyComputer_Description&quot;</span>);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a> blob = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a>(<span class="stringliteral">&quot;002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293&quot;</span>);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            UnionCodeGroup unionCodeGroup3 = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            unionCodeGroup3.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;FullTrust&quot;</span>, <span class="keyword">new</span> StrongNameMembershipCondition(blob, <span class="keyword">null</span>, <span class="keyword">null</span>).<a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">ToXml</a>()), <span class="keyword">this</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            unionCodeGroup3.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Microsoft_Name&quot;</span>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            unionCodeGroup3.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Microsoft_Description&quot;</span>);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            unionCodeGroup2.AddChildInternal(unionCodeGroup3);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            blob = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a>(<span class="stringliteral">&quot;00000000000000000400000000000000&quot;</span>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            UnionCodeGroup unionCodeGroup4 = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            unionCodeGroup4.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;FullTrust&quot;</span>, <span class="keyword">new</span> StrongNameMembershipCondition(blob, <span class="keyword">null</span>, <span class="keyword">null</span>).<a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">ToXml</a>()), <span class="keyword">this</span>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            unionCodeGroup4.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Ecma_Name&quot;</span>);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            unionCodeGroup4.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Ecma_Description&quot;</span>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            unionCodeGroup2.AddChildInternal(unionCodeGroup4);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            unionCodeGroup.AddChildInternal(unionCodeGroup2);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            CodeGroup codeGroup = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            codeGroup.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;LocalIntranet&quot;</span>, <span class="keyword">new</span> ZoneMembershipCondition(<a class="code" href="namespace_system_1_1_security.html#ace876efc23086dc690af1935e4ed3430">SecurityZone</a>.Intranet).ToXml()), <span class="keyword">this</span>);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            codeGroup.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Intranet_Name&quot;</span>);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            codeGroup.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Intranet_Description&quot;</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            CodeGroup codeGroup2 = <span class="keyword">new</span> NetCodeGroup(<span class="keyword">new</span> AllMembershipCondition());</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            codeGroup2.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_IntranetNet_Name&quot;</span>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            codeGroup2.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_IntranetNet_Description&quot;</span>);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            codeGroup.AddChildInternal(codeGroup2);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            CodeGroup codeGroup3 = <span class="keyword">new</span> FileCodeGroup(<span class="keyword">new</span> AllMembershipCondition(), <a class="code" href="namespace_system_1_1_security_1_1_permissions.html#a408c43cc9ad05c45e9b1546bbbd0f749">FileIOPermissionAccess</a>.Read | <a class="code" href="namespace_system_1_1_security_1_1_permissions.html#a408c43cc9ad05c45e9b1546bbbd0f749">FileIOPermissionAccess</a>.PathDiscovery);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            codeGroup3.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_IntranetFile_Name&quot;</span>);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            codeGroup3.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_IntranetFile_Description&quot;</span>);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            codeGroup.AddChildInternal(codeGroup3);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            unionCodeGroup.AddChildInternal(codeGroup);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            CodeGroup codeGroup4 = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            codeGroup4.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;Internet&quot;</span>, <span class="keyword">new</span> ZoneMembershipCondition(<a class="code" href="namespace_system_1_1_security.html#ace876efc23086dc690af1935e4ed3430">SecurityZone</a>.Internet).ToXml()), <span class="keyword">this</span>);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            codeGroup4.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Internet_Name&quot;</span>);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            codeGroup4.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Internet_Description&quot;</span>);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            CodeGroup codeGroup5 = <span class="keyword">new</span> NetCodeGroup(<span class="keyword">new</span> AllMembershipCondition());</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            codeGroup5.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_InternetNet_Name&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            codeGroup5.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_InternetNet_Description&quot;</span>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            codeGroup4.AddChildInternal(codeGroup5);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            unionCodeGroup.AddChildInternal(codeGroup4);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            CodeGroup codeGroup6 = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            codeGroup6.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;Nothing&quot;</span>, <span class="keyword">new</span> ZoneMembershipCondition(<a class="code" href="namespace_system_1_1_security.html#ace876efc23086dc690af1935e4ed3430">SecurityZone</a>.Untrusted).ToXml()), <span class="keyword">this</span>);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            codeGroup6.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Untrusted_Name&quot;</span>);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            codeGroup6.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Untrusted_Description&quot;</span>);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            unionCodeGroup.AddChildInternal(codeGroup6);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            CodeGroup codeGroup7 = <span class="keyword">new</span> UnionCodeGroup();</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            codeGroup7.FromXml(CreateCodeGroupElement(<span class="stringliteral">&quot;UnionCodeGroup&quot;</span>, <span class="stringliteral">&quot;Internet&quot;</span>, <span class="keyword">new</span> ZoneMembershipCondition(<a class="code" href="namespace_system_1_1_security.html#ace876efc23086dc690af1935e4ed3430">SecurityZone</a>.Trusted).ToXml()), <span class="keyword">this</span>);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            codeGroup7.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Trusted_Name&quot;</span>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            codeGroup7.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_Trusted_Description&quot;</span>);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            CodeGroup codeGroup8 = <span class="keyword">new</span> NetCodeGroup(<span class="keyword">new</span> AllMembershipCondition());</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            codeGroup8.Name = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_TrustedNet_Name&quot;</span>);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            codeGroup8.Description = Environment.GetResourceString(<span class="stringliteral">&quot;Policy_TrustedNet_Description&quot;</span>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            codeGroup7.AddChildInternal(codeGroup8);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            unionCodeGroup.AddChildInternal(codeGroup7);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">return</span> unionCodeGroup;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        }</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> SecurityElement CreateCodeGroupElement(<span class="keywordtype">string</span> codeGroupType, <span class="keywordtype">string</span> permissionSetName, SecurityElement mshipElement)</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            SecurityElement securityElement = <span class="keyword">new</span> SecurityElement(<span class="stringliteral">&quot;CodeGroup&quot;</span>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            securityElement.AddAttribute(<span class="stringliteral">&quot;class&quot;</span>, (<span class="stringliteral">&quot;System.Security.&quot;</span> + codeGroupType + <span class="stringliteral">&quot;, mscorlib, Version={VERSION}, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;</span>) ?? <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            securityElement.AddAttribute(<span class="stringliteral">&quot;version&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            securityElement.AddAttribute(<span class="stringliteral">&quot;PermissionSetName&quot;</span>, permissionSetName);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            securityElement.AddChild(mshipElement);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">return</span> securityElement;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SetDefaultFullTrustAssemblies()</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            m_fullTrustAssemblies = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a> blob = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a>(<span class="stringliteral">&quot;00000000000000000400000000000000&quot;</span>);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; EcmaFullTrustAssemblies.Length; i++)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                StrongNameMembershipCondition <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804">value</a> = <span class="keyword">new</span> StrongNameMembershipCondition(blob, EcmaFullTrustAssemblies[i], <span class="keyword">new</span> <a class="code" href="namespace_system.html#a0a07336c131df63f71cf8d279bce526da34b6cd75171affba6957e308dcbd92be">Version</a>(<span class="stringliteral">&quot;4.0.0.0&quot;</span>));</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                m_fullTrustAssemblies.Add(value);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a> blob2 = <span class="keyword">new</span> <a class="code" href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">StrongNamePublicKeyBlob</a>(<span class="stringliteral">&quot;002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293&quot;</span>);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; MicrosoftFullTrustAssemblies.Length; j++)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                StrongNameMembershipCondition value2 = <span class="keyword">new</span> StrongNameMembershipCondition(blob2, MicrosoftFullTrustAssemblies[j], <span class="keyword">new</span> <a class="code" href="namespace_system.html#a0a07336c131df63f71cf8d279bce526da34b6cd75171affba6957e308dcbd92be">Version</a>(<span class="stringliteral">&quot;4.0.0.0&quot;</span>));</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                m_fullTrustAssemblies.Add(value2);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SetDefault()</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        {</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            lock (<span class="keyword">this</span>)</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            {</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                <span class="keywordtype">string</span> path = GetLocationFromType(m_type) + <span class="stringliteral">&quot;.default&quot;</span>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_system_1_1_i_o_1_1_file.html">File</a>.InternalExists(path))</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                {</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                    PolicyLevel policyLevel = <span class="keyword">new</span> PolicyLevel(m_type, path);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                    m_rootCodeGroup = policyLevel.RootCodeGroup;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    m_namedPermissionSets = (<a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>)policyLevel.NamedPermissionSets;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    m_fullTrustAssemblies = (<a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>)policyLevel.FullTrustAssemblies;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    m_loaded = <span class="keyword">true</span>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                    m_namedPermissionSets = <span class="keyword">null</span>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    m_rootCodeGroup = <span class="keyword">null</span>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                    m_permSetElement = <span class="keyword">null</span>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                    m_rootCodeGroup = ((m_type == <a class="code" href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">PolicyLevelType</a>.Machine) ? CreateDefaultMachinePolicy() : CreateDefaultAllGroup());</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                    SetFactoryPermissionSets();</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                    SetDefaultFullTrustAssemblies();</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    m_loaded = <span class="keyword">true</span>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            }</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SetFactoryPermissionSets()</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            lock (InternalSyncObject)</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                m_namedPermissionSets = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.FullTrust);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.Everything);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.Nothing);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.SkipVerification);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.Execution);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.Internet);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                m_namedPermissionSets.Add(BuiltInPermissionSets.LocalIntranet);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        }</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keyword">private</span> SecurityElement FindElement(SecurityElement element, <span class="keywordtype">string</span> name)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        {</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = element.Children.GetEnumerator();</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                SecurityElement securityElement = (SecurityElement)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                if (securityElement.Tag.Equals(<span class="stringliteral">&quot;PermissionSet&quot;</span>))</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                {</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    <span class="keywordtype">string</span> text = securityElement.Attribute(<span class="stringliteral">&quot;Name&quot;</span>);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    <span class="keywordflow">if</span> (text != <span class="keyword">null</span> &amp;&amp; text.Equals(name))</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                        element.InternalChildren.Remove(securityElement);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        <span class="keywordflow">return</span> securityElement;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        }</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> LoadAllPermissionSets()</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <span class="keywordflow">if</span> (m_permSetElement != <span class="keyword">null</span> &amp;&amp; m_permSetElement.InternalChildren != <span class="keyword">null</span>)</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                lock (InternalSyncObject)</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    <span class="keywordflow">while</span> (m_permSetElement != <span class="keyword">null</span> &amp;&amp; m_permSetElement.InternalChildren.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a> != 0)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                    {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                        SecurityElement securityElement = (SecurityElement)m_permSetElement.<a class="code" href="class_system_1_1_security_1_1_security_element.html#ad24193db4883540cf336dcec27d9aea2">Children</a>[m_permSetElement.InternalChildren.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a> - 1];</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                        m_permSetElement.InternalChildren.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a8c936196f485ce7fb2d89baf324a6369">RemoveAt</a>(m_permSetElement.InternalChildren.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a> - 1);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                        <span class="keywordflow">if</span> (securityElement.Tag.Equals(<span class="stringliteral">&quot;PermissionSet&quot;</span>) &amp;&amp; securityElement.Attribute(<span class="stringliteral">&quot;class&quot;</span>).Equals(<span class="stringliteral">&quot;System.Security.NamedPermissionSet&quot;</span>))</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        {</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                            NamedPermissionSet namedPermissionSet = <span class="keyword">new</span> NamedPermissionSet();</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                            namedPermissionSet.FromXmlNameOnly(securityElement);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                            <span class="keywordflow">if</span> (namedPermissionSet.Name != <span class="keyword">null</span>)</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                            {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                m_namedPermissionSets.Add(namedPermissionSet);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                <span class="keywordflow">try</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                    namedPermissionSet.FromXml(securityElement, allowInternalOnly: <span class="keyword">false</span>, ignoreTypeLoadFailures: <span class="keyword">true</span>);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                <span class="keywordflow">catch</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                    m_namedPermissionSets.Remove(namedPermissionSet);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                }</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                            }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                        }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                    }</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                    m_permSetElement = <span class="keyword">null</span>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        [SecurityCritical]</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> GenericResolve(Evidence evidence, out <span class="keywordtype">bool</span> allConst)</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        {</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            CodeGroupStack codeGroupStack = <span class="keyword">new</span> CodeGroupStack();</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            CodeGroup rootCodeGroup = m_rootCodeGroup;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="keywordflow">if</span> (rootCodeGroup == <span class="keyword">null</span>)</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> PolicyException(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_NonFullTrustAssembly&quot;</span>));</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            CodeGroupStackFrame codeGroupStackFrame = <span class="keyword">new</span> CodeGroupStackFrame();</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            codeGroupStackFrame.current = rootCodeGroup;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            codeGroupStackFrame.parent = <span class="keyword">null</span>;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            codeGroupStack.Push(codeGroupStackFrame);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a> arrayList = <span class="keyword">new</span> <a class="code" href="class_system_1_1_collections_1_1_array_list.html">ArrayList</a>();</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keywordtype">bool</span> flag = <span class="keyword">false</span>;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            allConst = <span class="keyword">true</span>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            Exception ex = <span class="keyword">null</span>;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            <span class="keywordflow">while</span> (!codeGroupStack.IsEmpty())</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            {</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                codeGroupStackFrame = codeGroupStack.Pop();</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                FirstMatchCodeGroup firstMatchCodeGroup = codeGroupStackFrame.current as FirstMatchCodeGroup;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                UnionCodeGroup unionCodeGroup = codeGroupStackFrame.current as UnionCodeGroup;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                <span class="keywordflow">if</span> (!(codeGroupStackFrame.current.MembershipCondition is IConstantMembershipCondition) || (unionCodeGroup == <span class="keyword">null</span> &amp;&amp; firstMatchCodeGroup == <span class="keyword">null</span>))</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    allConst = <span class="keyword">false</span>;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                    codeGroupStackFrame.policy = PolicyManager.ResolveCodeGroup(codeGroupStackFrame.current, evidence);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                <span class="keywordflow">catch</span> (Exception ex2)</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                    <span class="keywordflow">if</span> (ex == <span class="keyword">null</span>)</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                    {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                        ex = ex2;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                    }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                <span class="keywordflow">if</span> (codeGroupStackFrame.policy == <span class="keyword">null</span>)</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                {</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                }</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                <span class="keywordflow">if</span> ((codeGroupStackFrame.policy.Attributes &amp; <a class="code" href="namespace_system_1_1_security_1_1_policy.html#ac8244eac6f2b5abb898a0cf277de2ad9">PolicyStatementAttribute</a>.Exclusive) != 0)</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                {</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    <span class="keywordflow">if</span> (flag)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                    {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> PolicyException(Environment.GetResourceString(<span class="stringliteral">&quot;Policy_MultipleExclusive&quot;</span>));</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                    }</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a88844e7aa7f7336de7b3718189693208">RemoveRange</a>(0, arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">Count</a>);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(codeGroupStackFrame);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    flag = <span class="keyword">true</span>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                <span class="keywordflow">if</span> (!flag)</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                {</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                    arrayList.<a class="code" href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">Add</a>(codeGroupStackFrame);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            }</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keywordflow">if</span> (ex != <span class="keyword">null</span>)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="keywordflow">throw</span> ex;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keywordflow">return</span> arrayList;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> GenerateFriendlyName(<span class="keywordtype">string</span> className, <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> classes)</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            <span class="keywordflow">if</span> (classes.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a93d0b059f7848073a738a98ce426f842">ContainsKey</a>(className))</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            {</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                <span class="keywordflow">return</span> (<span class="keywordtype">string</span>)classes[className];</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <a class="code" href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ae3f83b98402a703771e6cb093271dbf7">Type</a> type = <a class="code" href="namespace_system.html">System</a>.<a class="code" href="class_system_1_1_type.html">Type</a>.<a class="code" href="class_system_1_1_type.html#a4f53518d4bf1282dc89372c425c07d6f">GetType</a>(className, throwOnError: <span class="keyword">false</span>, ignoreCase: <span class="keyword">false</span>);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="keywordflow">if</span> (type != <span class="keyword">null</span> &amp;&amp; !type.IsVisible)</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                type = <span class="keyword">null</span>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            }</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordflow">if</span> (type == <span class="keyword">null</span>)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                <span class="keywordflow">return</span> className;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            }</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordflow">if</span> (!classes.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a88f4a8b6f76d6bd0121a00f9f0220388">ContainsValue</a>(type.Name))</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                classes.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a0860df05ec1cf7b9f6650d9de653c8dd">Add</a>(className, type.Name);</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="keywordflow">return</span> type.Name;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            }</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="keywordflow">if</span> (!classes.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a88f4a8b6f76d6bd0121a00f9f0220388">ContainsValue</a>(type.FullName))</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            {</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                classes.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a0860df05ec1cf7b9f6650d9de653c8dd">Add</a>(className, type.FullName);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                <span class="keywordflow">return</span> type.FullName;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            classes.<a class="code" href="class_system_1_1_collections_1_1_hashtable.html#a0860df05ec1cf7b9f6650d9de653c8dd">Add</a>(className, type.AssemblyQualifiedName);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="keywordflow">return</span> type.AssemblyQualifiedName;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keyword">private</span> SecurityElement NormalizeClassDeep(SecurityElement elem, <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> classes)</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            NormalizeClass(elem, classes);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <span class="keywordflow">if</span> (elem.InternalChildren != <span class="keyword">null</span> &amp;&amp; elem.InternalChildren.Count &gt; 0)</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = elem.Children.GetEnumerator();</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                {</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                    NormalizeClassDeep((SecurityElement)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>, classes);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                }</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="keyword">private</span> SecurityElement NormalizeClass(SecurityElement elem, <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> classes)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        {</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            <span class="keywordflow">if</span> (elem.m_lAttributes == <span class="keyword">null</span> || elem.m_lAttributes.Count == 0)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            }</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ae2942a04780e223b215eb8b663cf5353">count</a> = elem.m_lAttributes.Count;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ae2942a04780e223b215eb8b663cf5353">count</a>; i += 2)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                <span class="keywordtype">string</span> text = (string)elem.m_lAttributes[i];</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                if (text.Equals(<span class="stringliteral">&quot;class&quot;</span>))</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                    <span class="keywordtype">string</span> className = (string)elem.m_lAttributes[i + 1];</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    elem.m_lAttributes[i + 1] = GenerateFriendlyName(className, classes);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                }</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            }</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keyword">private</span> SecurityElement UnnormalizeClassDeep(SecurityElement elem, <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> classes)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            UnnormalizeClass(elem, classes);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <span class="keywordflow">if</span> (elem.InternalChildren != <span class="keyword">null</span> &amp;&amp; elem.InternalChildren.Count &gt; 0)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            {</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html">IEnumerator</a> enumerator = elem.Children.GetEnumerator();</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                <span class="keywordflow">while</span> (enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">MoveNext</a>())</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                    UnnormalizeClassDeep((SecurityElement)enumerator.<a class="code" href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">Current</a>, classes);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="keyword">private</span> SecurityElement UnnormalizeClass(SecurityElement elem, <a class="code" href="class_system_1_1_collections_1_1_hashtable.html">Hashtable</a> classes)</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keywordflow">if</span> (classes == <span class="keyword">null</span> || elem.m_lAttributes == <span class="keyword">null</span> || elem.m_lAttributes.Count == 0)</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            {</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ae2942a04780e223b215eb8b663cf5353">count</a> = elem.m_lAttributes.Count;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637ae2942a04780e223b215eb8b663cf5353">count</a>; i += 2)</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                <span class="keywordtype">string</span> text = (string)elem.m_lAttributes[i];</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                if (text.Equals(<span class="stringliteral">&quot;class&quot;</span>))</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                    <span class="keywordtype">string</span> <a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a3c6e0b8a9c15224a8228b9a98ca1531d">key</a> = (string)elem.m_lAttributes[i + 1];</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                    <span class="keywordtype">string</span> text2 = (<span class="keywordtype">string</span>)classes[<a class="code" href="namespace_system.html#a566c7365b77de53642aa0634953e1637a3c6e0b8a9c15224a8228b9a98ca1531d">key</a>];</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    <span class="keywordflow">if</span> (text2 != <span class="keyword">null</span>)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                    {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                        elem.m_lAttributes[i + 1] = text2;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                    }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        }</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    }</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;}</div><div class="ttc" id="class_system_1_1_text_1_1_encoding_html"><div class="ttname"><a href="class_system_1_1_text_1_1_encoding.html">System.Text.Encoding</a></div><div class="ttdoc">Represents a character encoding.To browse the .NET Framework source code for this type,...</div><div class="ttdef"><b>Definition:</b> <a href="_encoding_8cs_source.html#l00015">Encoding.cs:15</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_html"><div class="ttname"><a href="namespace_system_1_1_security.html">System.Security</a></div><div class="ttdef"><b>Definition:</b> <a href="_allow_partially_trusted_callers_attribute_8cs_source.html#l00003">AllowPartiallyTrustedCallersAttribute.cs:3</a></div></div>
<div class="ttc" id="namespace_system_1_1_text_html"><div class="ttname"><a href="namespace_system_1_1_text.html">System.Text</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_s_c_i_i_encoding_8cs_source.html#l00004">ASCIIEncoding.cs:4</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_code_group_html_a125ac26313cbc430328e1eb0e4b18647"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a125ac26313cbc430328e1eb0e4b18647">System.Security.Policy.CodeGroup.ResolveMatchingCodeGroups</a></div><div class="ttdeci">abstract CodeGroup ResolveMatchingCodeGroups(Evidence evidence)</div><div class="ttdoc">When overridden in a derived class, resolves matching code groups.</div></div>
<div class="ttc" id="class_system_1_1_security_1_1_permission_set_html_a3727f9e512d890f2ea741586d49b850c"><div class="ttname"><a href="class_system_1_1_security_1_1_permission_set.html#a3727f9e512d890f2ea741586d49b850c">System.Security.PermissionSet.IsUnrestricted</a></div><div class="ttdeci">bool IsUnrestricted()</div><div class="ttdoc">Determines whether the T:System.Security.PermissionSet is Unrestricted.</div><div class="ttdef"><b>Definition:</b> <a href="_permission_set_8cs_source.html#l00519">PermissionSet.cs:519</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_af59c5fd5007be56e941733b789efcbc3"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af59c5fd5007be56e941733b789efcbc3">System.Security.Policy.PolicyLevel.AddFullTrustAssembly</a></div><div class="ttdeci">void AddFullTrustAssembly(StrongName sn)</div><div class="ttdoc">Adds a T:System.Security.Policy.StrongNameMembershipCondition corresponding to the specified T:System...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00328">PolicyLevel.cs:328</a></div></div>
<div class="ttc" id="class_system_1_1_argument_null_exception_html"><div class="ttname"><a href="class_system_1_1_argument_null_exception.html">System.ArgumentNullException</a></div><div class="ttdoc">The exception that is thrown when a null reference (Nothing in Visual Basic) is passed to a method th...</div><div class="ttdef"><b>Definition:</b> <a href="_argument_null_exception_8cs_source.html#l00011">ArgumentNullException.cs:11</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_permissions_1_1_security_permission_html"><div class="ttname"><a href="class_system_1_1_security_1_1_permissions_1_1_security_permission.html">System.Security.Permissions.SecurityPermission</a></div><div class="ttdoc">Describes a set of security permissions applied to code. This class cannot be inherited.</div><div class="ttdef"><b>Definition:</b> <a href="_security_permission_8cs_source.html#l00009">SecurityPermission.cs:9</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_permissions_html_a408c43cc9ad05c45e9b1546bbbd0f749"><div class="ttname"><a href="namespace_system_1_1_security_1_1_permissions.html#a408c43cc9ad05c45e9b1546bbbd0f749">System.Security.Permissions.FileIOPermissionAccess</a></div><div class="ttdeci">FileIOPermissionAccess</div><div class="ttdoc">Specifies the type of file access requested.</div><div class="ttdef"><b>Definition:</b> <a href="_file_i_o_permission_access_8cs_source.html#l00009">FileIOPermissionAccess.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_text_1_1_encoding_html_aede7f91d315dea0edff82c851f79d0e1"><div class="ttname"><a href="class_system_1_1_text_1_1_encoding.html#aede7f91d315dea0edff82c851f79d0e1">System.Text.Encoding.GetString</a></div><div class="ttdeci">unsafe string GetString(byte *bytes, int byteCount)</div><div class="ttdoc">When overridden in a derived class, decodes a specified number of bytes starting at a specified addre...</div><div class="ttdef"><b>Definition:</b> <a href="_encoding_8cs_source.html#l01918">Encoding.cs:1918</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_hashtable_html_a0860df05ec1cf7b9f6650d9de653c8dd"><div class="ttname"><a href="class_system_1_1_collections_1_1_hashtable.html#a0860df05ec1cf7b9f6650d9de653c8dd">System.Collections.Hashtable.Add</a></div><div class="ttdeci">virtual void Add(object key, object value)</div><div class="ttdoc">Adds an element with the specified key and value into the T:System.Collections.Hashtable.</div><div class="ttdef"><b>Definition:</b> <a href="_hashtable_8cs_source.html#l00916">Hashtable.cs:916</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_enumerator_html_a38aa786daa1b21fa0da301cbe4f6a205"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_enumerator.html#a38aa786daa1b21fa0da301cbe4f6a205">System.Collections.IEnumerator.MoveNext</a></div><div class="ttdeci">bool MoveNext()</div><div class="ttdoc">Advances the enumerator to the next element of the collection.</div></div>
<div class="ttc" id="class_system_1_1_security_1_1_permission_set_html_a9f013896aacd59ffdf99d9b2e0911f17"><div class="ttname"><a href="class_system_1_1_security_1_1_permission_set.html#a9f013896aacd59ffdf99d9b2e0911f17">System.Security.PermissionSet.GetEnumerator</a></div><div class="ttdeci">IEnumerator GetEnumerator()</div><div class="ttdoc">Returns an enumerator for the permissions of the set.</div><div class="ttdef"><b>Definition:</b> <a href="_permission_set_8cs_source.html#l01421">PermissionSet.cs:1421</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_strong_name_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_strong_name.html">System.Security.Policy.StrongName</a></div><div class="ttdoc">Provides the strong name of a code assembly as evidence for policy evaluation. This class cannot be i...</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_8cs_source.html#l00012">StrongName.cs:12</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_html_ace876efc23086dc690af1935e4ed3430"><div class="ttname"><a href="namespace_system_1_1_security.html#ace876efc23086dc690af1935e4ed3430">System.Security.SecurityZone</a></div><div class="ttdeci">SecurityZone</div><div class="ttdoc">Defines the integer values corresponding to security zones used by security policy.</div><div class="ttdef"><b>Definition:</b> <a href="_security_zone_8cs_source.html#l00008">SecurityZone.cs:8</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a8d4479ae855aa13452546dbc6350ba76"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8d4479ae855aa13452546dbc6350ba76">System.Security.Policy.PolicyLevel.FromXml</a></div><div class="ttdeci">void FromXml(SecurityElement e)</div><div class="ttdoc">Reconstructs a security object with a given state from an XML encoding.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00661">PolicyLevel.cs:661</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_aea4065ac888575ab6a40d4ca27775482"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#aea4065ac888575ab6a40d4ca27775482">System.Security.Policy.PolicyLevel.StoreLocation</a></div><div class="ttdeci">string StoreLocation</div><div class="ttdoc">Gets the path where the policy file is stored.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00099">PolicyLevel.cs:99</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_html_a983961c7dfa4c2e54fa3a5ae9a83b009"><div class="ttname"><a href="namespace_system_1_1_security.html#a983961c7dfa4c2e54fa3a5ae9a83b009">System.Security.PolicyLevelType</a></div><div class="ttdeci">PolicyLevelType</div><div class="ttdoc">Specifies the type of a managed code policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_type_8cs_source.html#l00008">PolicyLevelType.cs:8</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_array_list_html_a8c936196f485ce7fb2d89baf324a6369"><div class="ttname"><a href="class_system_1_1_collections_1_1_array_list.html#a8c936196f485ce7fb2d89baf324a6369">System.Collections.ArrayList.RemoveAt</a></div><div class="ttdeci">virtual void RemoveAt(int index)</div><div class="ttdoc">Removes the element at the specified index of the T:System.Collections.ArrayList.</div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l02847">ArrayList.cs:2847</a></div></div>
<div class="ttc" id="namespace_system_1_1_runtime_1_1_interop_services_html"><div class="ttname"><a href="namespace_system_1_1_runtime_1_1_interop_services.html">System.Runtime.InteropServices</a></div><div class="ttdef"><b>Definition:</b> <a href="___activator_8cs_source.html#l00001">_Activator.cs:1</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_dictionary_enumerator_html_aaab78842b39cbe2310cf3b3f21ee9560"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_dictionary_enumerator.html#aaab78842b39cbe2310cf3b3f21ee9560">System.Collections.IDictionaryEnumerator.Key</a></div><div class="ttdeci">object Key</div><div class="ttdoc">Gets the key of the current dictionary entry.</div><div class="ttdef"><b>Definition:</b> <a href="_i_dictionary_enumerator_8cs_source.html#l00015">IDictionaryEnumerator.cs:15</a></div></div>
<div class="ttc" id="namespace_system_1_1_i_o_html_a806eadc224c3dfd0d87ac587bb376184"><div class="ttname"><a href="namespace_system_1_1_i_o.html#a806eadc224c3dfd0d87ac587bb376184">System.IO.FileMode</a></div><div class="ttdeci">FileMode</div><div class="ttdoc">Specifies how the operating system should open a file.</div><div class="ttdef"><b>Definition:</b> <a href="_file_mode_8cs_source.html#l00008">FileMode.cs:8</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_list_html"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_list.html">System.Collections.IList</a></div><div class="ttdoc">Represents a non-generic collection of objects that can be individually accessed by index.</div><div class="ttdef"><b>Definition:</b> <a href="_i_list_8cs_source.html#l00008">IList.cs:8</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html">System.Security.Policy.PolicyLevel</a></div><div class="ttdoc">Represents the security policy levels for the common language runtime. This class cannot be inherited...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00015">PolicyLevel.cs:15</a></div></div>
<div class="ttc" id="namespace_system_1_1_runtime_html"><div class="ttname"><a href="namespace_system_1_1_runtime.html">System.Runtime</a></div><div class="ttdef"><b>Definition:</b> <a href="_assembly_targeted_patch_band_attribute_8cs_source.html#l00001">AssemblyTargetedPatchBandAttribute.cs:1</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_code_group_html_a772b7a61e77f428cd796ccf6079ed79b"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a772b7a61e77f428cd796ccf6079ed79b">System.Security.Policy.CodeGroup.FromXml</a></div><div class="ttdeci">void FromXml(SecurityElement e)</div><div class="ttdoc">Reconstructs a security object with a given state from an XML encoding.</div><div class="ttdef"><b>Definition:</b> <a href="_code_group_8cs_source.html#l00330">CodeGroup.cs:330</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_array_list_html_abe380bb45ae53f925b398b7c73cd8a97"><div class="ttname"><a href="class_system_1_1_collections_1_1_array_list.html#abe380bb45ae53f925b398b7c73cd8a97">System.Collections.ArrayList.Count</a></div><div class="ttdeci">virtual int Count</div><div class="ttdoc">Gets the number of elements actually contained in the T:System.Collections.ArrayList.</div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l02255">ArrayList.cs:2255</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div><div class="ttdef"><b>Definition:</b> <a href="_____canon_8cs_source.html#l00003">__Canon.cs:3</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_policy_html_ac8244eac6f2b5abb898a0cf277de2ad9"><div class="ttname"><a href="namespace_system_1_1_security_1_1_policy.html#ac8244eac6f2b5abb898a0cf277de2ad9">System.Security.Policy.PolicyStatementAttribute</a></div><div class="ttdeci">PolicyStatementAttribute</div><div class="ttdoc">Defines special attribute flags for security policy on code groups.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_statement_attribute_8cs_source.html#l00009">PolicyStatementAttribute.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_strong_name_html_a45faeec13ad9932786d6560c58d3624b"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a45faeec13ad9932786d6560c58d3624b">System.Security.Policy.StrongName.PublicKey</a></div><div class="ttdeci">StrongNamePublicKeyBlob PublicKey</div><div class="ttdoc">Gets the T:System.Security.Permissions.StrongNamePublicKeyBlob of the current T:System....</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_8cs_source.html#l00028">StrongName.cs:28</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_security_element_html_a3829be72382aafa67029ed718e66d838"><div class="ttname"><a href="class_system_1_1_security_1_1_security_element.html#a3829be72382aafa67029ed718e66d838">System.Security.SecurityElement.SearchForChildByTag</a></div><div class="ttdeci">SecurityElement SearchForChildByTag(string tag)</div><div class="ttdoc">Finds a child by its tag name.</div><div class="ttdef"><b>Definition:</b> <a href="_security_element_8cs_source.html#l00757">SecurityElement.cs:757</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_strong_name_html_a42f6643709acd58b896d36d12d3ebbea"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a42f6643709acd58b896d36d12d3ebbea">System.Security.Policy.StrongName.Version</a></div><div class="ttdeci">Version Version</div><div class="ttdoc">Gets the T:System.Version of the current T:System.Security.Policy.StrongName.</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_8cs_source.html#l00036">StrongName.cs:36</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_permission_set_html_a1147e6c2840aa84c1c84e7358d8140da"><div class="ttname"><a href="class_system_1_1_security_1_1_permission_set.html#a1147e6c2840aa84c1c84e7358d8140da">System.Security.PermissionSet.SetPermission</a></div><div class="ttdeci">IPermission SetPermission(IPermission perm)</div><div class="ttdoc">Sets a permission to the T:System.Security.PermissionSet, replacing any existing permission of the sa...</div><div class="ttdef"><b>Definition:</b> <a href="_permission_set_8cs_source.html#l00402">PermissionSet.cs:402</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637ab068931cc450442b63f5b3d276ea4297">System.ExceptionArgument.name</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_named_permission_set_html_a6448392289ef8a21d97da082dfe8b407"><div class="ttname"><a href="class_system_1_1_security_1_1_named_permission_set.html#a6448392289ef8a21d97da082dfe8b407">System.Security.NamedPermissionSet.Name</a></div><div class="ttdeci">string Name</div><div class="ttdoc">Gets or sets the name of the current named permission set.</div><div class="ttdef"><b>Definition:</b> <a href="_named_permission_set_8cs_source.html#l00026">NamedPermissionSet.cs:26</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637af1f713c9e000f5d3f280adbd124df4f5"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637af1f713c9e000f5d3f280adbd124df4f5">System.ExceptionArgument.array</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html">System.Security.Policy.StrongNameMembershipCondition</a></div><div class="ttdoc">Determines whether an assembly belongs to a code group by testing its strong name....</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_membership_condition_8cs_source.html#l00011">StrongNameMembershipCondition.cs:11</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_ae3f83b98402a703771e6cb093271dbf7"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ae3f83b98402a703771e6cb093271dbf7">System.Security.Policy.PolicyLevel.Type</a></div><div class="ttdeci">PolicyLevelType Type</div><div class="ttdoc">Gets the type of the policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00085">PolicyLevel.cs:85</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637ae2942a04780e223b215eb8b663cf5353"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637ae2942a04780e223b215eb8b663cf5353">System.ExceptionArgument.count</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a82b4f0b7537ccf39f114476871539abb"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a82b4f0b7537ccf39f114476871539abb">System.Security.Policy.PolicyLevel.RemoveNamedPermissionSet</a></div><div class="ttdeci">NamedPermissionSet RemoveNamedPermissionSet(NamedPermissionSet permSet)</div><div class="ttdoc">Removes the specified T:System.Security.NamedPermissionSet from the current policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00445">PolicyLevel.cs:445</a></div></div>
<div class="ttc" id="class_system_1_1_i_o_1_1_file_stream_html_add32fedfe35b2c0212214fcac8cf4398"><div class="ttname"><a href="class_system_1_1_i_o_1_1_file_stream.html#add32fedfe35b2c0212214fcac8cf4398">System.IO.FileStream.Read</a></div><div class="ttdeci">override int Read([In] [Out] byte[] array, int offset, int count)</div><div class="ttdoc">Reads a block of bytes from the stream and writes the data in a given buffer.</div><div class="ttdef"><b>Definition:</b> <a href="_file_stream_8cs_source.html#l01222">FileStream.cs:1222</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637a2063c1608d6e0baf80249c42e2be5804">System.ExceptionArgument.value</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_hashtable_html_a93d0b059f7848073a738a98ce426f842"><div class="ttname"><a href="class_system_1_1_collections_1_1_hashtable.html#a93d0b059f7848073a738a98ce426f842">System.Collections.Hashtable.ContainsKey</a></div><div class="ttdeci">virtual bool ContainsKey(object key)</div><div class="ttdoc">Determines whether the T:System.Collections.Hashtable contains a specific key.</div><div class="ttdef"><b>Definition:</b> <a href="_hashtable_8cs_source.html#l00983">Hashtable.cs:983</a></div></div>
<div class="ttc" id="struct_system_1_1_runtime_1_1_serialization_1_1_streaming_context_html"><div class="ttname"><a href="struct_system_1_1_runtime_1_1_serialization_1_1_streaming_context.html">System.Runtime.Serialization.StreamingContext</a></div><div class="ttdoc">Describes the source and destination of a given serialized stream, and provides an additional caller-...</div><div class="ttdef"><b>Definition:</b> <a href="_streaming_context_8cs_source.html#l00009">StreamingContext.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_security_element_html_a4449f33ab4e2a05ca30b6cec08d04dfa"><div class="ttname"><a href="class_system_1_1_security_1_1_security_element.html#a4449f33ab4e2a05ca30b6cec08d04dfa">System.Security.SecurityElement.Tag</a></div><div class="ttdeci">string Tag</div><div class="ttdoc">Gets or sets the tag name of an XML element.</div><div class="ttdef"><b>Definition:</b> <a href="_security_element_8cs_source.html#l00082">SecurityElement.cs:82</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a78f2d70740273172f5632161def9c66e"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a78f2d70740273172f5632161def9c66e">System.Security.Policy.PolicyLevel.ChangeNamedPermissionSet</a></div><div class="ttdeci">NamedPermissionSet ChangeNamedPermissionSet(string name, PermissionSet pSet)</div><div class="ttdoc">Replaces a T:System.Security.NamedPermissionSet in the current policy level with the specified T:Syst...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00519">PolicyLevel.cs:519</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_statement_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_statement.html">System.Security.Policy.PolicyStatement</a></div><div class="ttdoc">Represents the statement of a T:System.Security.Policy.CodeGroup describing the permissions and other...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_statement_8cs_source.html#l00014">PolicyStatement.cs:14</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637abe8f80182e0c983916da7338c2c1c040"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637abe8f80182e0c983916da7338c2c1c040">System.ExceptionArgument.obj</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_named_permission_set_html"><div class="ttname"><a href="class_system_1_1_security_1_1_named_permission_set.html">System.Security.NamedPermissionSet</a></div><div class="ttdoc">Defines a permission set that has a name and description associated with it. This class cannot be inh...</div><div class="ttdef"><b>Definition:</b> <a href="_named_permission_set_8cs_source.html#l00011">NamedPermissionSet.cs:11</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637a447b7147e84be512208dcc0995d67ebc"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637a447b7147e84be512208dcc0995d67ebc">System.ExceptionArgument.item</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_security_element_html_ad9456e3a1a711a475c015e65ece63916"><div class="ttname"><a href="class_system_1_1_security_1_1_security_element.html#ad9456e3a1a711a475c015e65ece63916">System.Security.SecurityElement.AddChild</a></div><div class="ttdeci">void AddChild(SecurityElement child)</div><div class="ttdoc">Adds a child element to the XML element.</div><div class="ttdef"><b>Definition:</b> <a href="_security_element_8cs_source.html#l00350">SecurityElement.cs:350</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a60ebf12f0cd36c980d03252a3f2cbe2e"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a60ebf12f0cd36c980d03252a3f2cbe2e">System.Security.Policy.PolicyLevel.Label</a></div><div class="ttdeci">string Label</div><div class="ttdoc">Gets a descriptive label for the policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00070">PolicyLevel.cs:70</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_code_group_html_a1485a3a41b5a86b600fd5dff20459bac"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a1485a3a41b5a86b600fd5dff20459bac">System.Security.Policy.CodeGroup.ToXml</a></div><div class="ttdeci">SecurityElement ToXml()</div><div class="ttdoc">Creates an XML encoding of the security object and its current state.</div><div class="ttdef"><b>Definition:</b> <a href="_code_group_8cs_source.html#l00322">CodeGroup.cs:322</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_permissions_html_ab37427d2235868b0c64804ad630baa72"><div class="ttname"><a href="namespace_system_1_1_security_1_1_permissions.html#ab37427d2235868b0c64804ad630baa72">System.Security.Permissions.SecurityAction</a></div><div class="ttdeci">SecurityAction</div><div class="ttdoc">Specifies the security actions that can be performed using declarative security.</div><div class="ttdef"><b>Definition:</b> <a href="_security_action_8cs_source.html#l00008">SecurityAction.cs:8</a></div></div>
<div class="ttc" id="class_system_1_1_environment_html"><div class="ttname"><a href="class_system_1_1_environment.html">System.Environment</a></div><div class="ttdoc">Provides information about, and means to manipulate, the current environment and platform....</div><div class="ttdef"><b>Definition:</b> <a href="_environment_8cs_source.html#l00021">Environment.cs:21</a></div></div>
<div class="ttc" id="class_system_1_1_i_o_1_1_stream_html_a6336b2150d4e31e34911d429c690757f"><div class="ttname"><a href="class_system_1_1_i_o_1_1_stream.html#a6336b2150d4e31e34911d429c690757f">System.IO.Stream.Close</a></div><div class="ttdeci">virtual void Close()</div><div class="ttdoc">Closes the current stream and releases any resources (such as sockets and file handles) associated wi...</div><div class="ttdef"><b>Definition:</b> <a href="_stream_8cs_source.html#l00855">Stream.cs:855</a></div></div>
<div class="ttc" id="namespace_system_html_a3468295287d2f03b02e4f473f0c4c310ae309e678d77a80e722dd1695137a5a21"><div class="ttname"><a href="namespace_system.html#a3468295287d2f03b02e4f473f0c4c310ae309e678d77a80e722dd1695137a5a21">System.TypeNameKind.FullName</a></div></div>
<div class="ttc" id="namespace_system_html_aa0aef5be110e36c32fb5312a4fdaec1a"><div class="ttname"><a href="namespace_system.html#aa0aef5be110e36c32fb5312a4fdaec1a">System.CompatibilityFlag</a></div><div class="ttdeci">CompatibilityFlag</div><div class="ttdef"><b>Definition:</b> <a href="_compatibility_flag_8cs_source.html#l00003">CompatibilityFlag.cs:3</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_code_group_html_a6eb495d447218aad835b60c16ff91a65"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a6eb495d447218aad835b60c16ff91a65">System.Security.Policy.CodeGroup.Children</a></div><div class="ttdeci">IList Children</div><div class="ttdoc">Gets or sets an ordered list of the child code groups of a code group.</div><div class="ttdef"><b>Definition:</b> <a href="_code_group_8cs_source.html#l00032">CodeGroup.cs:32</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_permission_set_html"><div class="ttname"><a href="class_system_1_1_security_1_1_permission_set.html">System.Security.PermissionSet</a></div><div class="ttdoc">Represents a collection that can contain many different types of permissions.</div><div class="ttdef"><b>Definition:</b> <a href="_permission_set_8cs_source.html#l00020">PermissionSet.cs:20</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition_html_ad60f746daf02356abb71d620100f728f"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_strong_name_membership_condition.html#ad60f746daf02356abb71d620100f728f">System.Security.Policy.StrongNameMembershipCondition.FromXml</a></div><div class="ttdeci">void FromXml(SecurityElement e)</div><div class="ttdoc">Reconstructs a security object with a specified state from an XML encoding.</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_membership_condition_8cs_source.html#l00188">StrongNameMembershipCondition.cs:188</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_security_element_html"><div class="ttname"><a href="class_system_1_1_security_1_1_security_element.html">System.Security.SecurityElement</a></div><div class="ttdoc">Represents the XML object model for encoding security objects. This class cannot be inherited.</div><div class="ttdef"><b>Definition:</b> <a href="_security_element_8cs_source.html#l00014">SecurityElement.cs:14</a></div></div>
<div class="ttc" id="class_system_1_1_threading_1_1_interlocked_html_a3df013d4fa027453ad9b618a3337d222"><div class="ttname"><a href="class_system_1_1_threading_1_1_interlocked.html#a3df013d4fa027453ad9b618a3337d222">System.Threading.Interlocked.CompareExchange</a></div><div class="ttdeci">static int CompareExchange(ref int location1, int value, int comparand)</div><div class="ttdoc">Compares two 32-bit signed integers for equality and, if they are equal, replaces the first value.</div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_hashtable_html"><div class="ttname"><a href="class_system_1_1_collections_1_1_hashtable.html">System.Collections.Hashtable</a></div><div class="ttdoc">Represents a collection of key/value pairs that are organized based on the hash code of the key....</div><div class="ttdef"><b>Definition:</b> <a href="_hashtable_8cs_source.html#l00017">Hashtable.cs:17</a></div></div>
<div class="ttc" id="class_system_1_1_i_o_1_1_file_stream_html"><div class="ttname"><a href="class_system_1_1_i_o_1_1_file_stream.html">System.IO.FileStream</a></div><div class="ttdoc">Provides a T:System.IO.Stream for a file, supporting both synchronous and asynchronous read and write...</div><div class="ttdef"><b>Definition:</b> <a href="_file_stream_8cs_source.html#l00015">FileStream.cs:15</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_policy_html_ad38c269e2749eeacc5996f4840cd807b"><div class="ttname"><a href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807b">System.Security.Policy.ConfigId</a></div><div class="ttdeci">ConfigId</div><div class="ttdef"><b>Definition:</b> <a href="_config_id_8cs_source.html#l00004">ConfigId.cs:4</a></div></div>
<div class="ttc" id="namespace_system_1_1_i_o_html"><div class="ttname"><a href="namespace_system_1_1_i_o.html">System.IO</a></div><div class="ttdef"><b>Definition:</b> <a href="_____console_stream_8cs_source.html#l00007">__ConsoleStream.cs:7</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_enumerator_html_a4c6fbf6709bd0463824ca23824424178"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_enumerator.html#a4c6fbf6709bd0463824ca23824424178">System.Collections.IEnumerator.Current</a></div><div class="ttdeci">object Current</div><div class="ttdoc">Gets the element in the collection at the current position of the enumerator.</div><div class="ttdef"><b>Definition:</b> <a href="_system_8_collections_2_i_enumerator_8cs_source.html#l00015">IEnumerator.cs:15</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_code_group_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_code_group.html">System.Security.Policy.CodeGroup</a></div><div class="ttdoc">Represents the abstract base class from which all implementations of code groups must derive.</div><div class="ttdef"><b>Definition:</b> <a href="_code_group_8cs_source.html#l00011">CodeGroup.cs:11</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_built_in_permission_sets_html"><div class="ttname"><a href="class_system_1_1_security_1_1_built_in_permission_sets.html">System.Security.BuiltInPermissionSets</a></div><div class="ttdef"><b>Definition:</b> <a href="_built_in_permission_sets_8cs_source.html#l00005">BuiltInPermissionSets.cs:5</a></div></div>
<div class="ttc" id="namespace_system_1_1_runtime_1_1_serialization_html"><div class="ttname"><a href="namespace_system_1_1_runtime_1_1_serialization.html">System.Runtime.Serialization</a></div><div class="ttdef"><b>Definition:</b> <a href="_deserialization_event_handler_8cs_source.html#l00001">DeserializationEventHandler.cs:1</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_ab0f410fac6284b2de7319065c6bb46ff"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab0f410fac6284b2de7319065c6bb46ff">System.Security.Policy.PolicyLevel.Reset</a></div><div class="ttdeci">void Reset()</div><div class="ttdoc">Returns the current policy level to the default state.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00599">PolicyLevel.cs:599</a></div></div>
<div class="ttc" id="class_system_1_1_type_html"><div class="ttname"><a href="class_system_1_1_type.html">System.Type</a></div><div class="ttdoc">Represents type declarations: class types, interface types, array types, value types,...</div><div class="ttdef"><b>Definition:</b> <a href="_type_8cs_source.html#l00018">Type.cs:18</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_named_permission_set_html_a30b077d033804444441581161fa787c6"><div class="ttname"><a href="class_system_1_1_security_1_1_named_permission_set.html#a30b077d033804444441581161fa787c6">System.Security.NamedPermissionSet.Copy</a></div><div class="ttdeci">override PermissionSet Copy()</div><div class="ttdoc">Creates a permission set copy from a named permission set.</div><div class="ttdef"><b>Definition:</b> <a href="_named_permission_set_8cs_source.html#l00131">NamedPermissionSet.cs:131</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_abd80e2f17d8263ed14dfc58c202973e9"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#abd80e2f17d8263ed14dfc58c202973e9">System.Security.Policy.PolicyLevel.RootCodeGroup</a></div><div class="ttdeci">CodeGroup RootCodeGroup</div><div class="ttdoc">Gets or sets the root code group for the policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00112">PolicyLevel.cs:112</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_array_list_html_a88844e7aa7f7336de7b3718189693208"><div class="ttname"><a href="class_system_1_1_collections_1_1_array_list.html#a88844e7aa7f7336de7b3718189693208">System.Collections.ArrayList.RemoveRange</a></div><div class="ttdeci">virtual void RemoveRange(int index, int count)</div><div class="ttdoc">Removes a range of elements from the T:System.Collections.ArrayList.</div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l02871">ArrayList.cs:2871</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_enumerable_html_a254796d00735d72da46328daa0fa52cd"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_enumerable.html#a254796d00735d72da46328daa0fa52cd">System.Collections.IEnumerable.GetEnumerator</a></div><div class="ttdeci">IEnumerator GetEnumerator()</div><div class="ttdoc">Returns an enumerator that iterates through a collection.</div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_hashtable_html_a88f4a8b6f76d6bd0121a00f9f0220388"><div class="ttname"><a href="class_system_1_1_collections_1_1_hashtable.html#a88f4a8b6f76d6bd0121a00f9f0220388">System.Collections.Hashtable.ContainsValue</a></div><div class="ttdeci">virtual bool ContainsValue(object value)</div><div class="ttdoc">Determines whether the T:System.Collections.Hashtable contains a specific value.</div><div class="ttdef"><b>Definition:</b> <a href="_hashtable_8cs_source.html#l01017">Hashtable.cs:1017</a></div></div>
<div class="ttc" id="interface_system_1_1_security_1_1_i_permission_html"><div class="ttname"><a href="interface_system_1_1_security_1_1_i_permission.html">System.Security.IPermission</a></div><div class="ttdoc">Defines methods implemented by permission types.</div><div class="ttdef"><b>Definition:</b> <a href="_i_permission_8cs_source.html#l00007">IPermission.cs:7</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_array_list_html_a0ac362c523bd9da37ebd176c7725a276"><div class="ttname"><a href="class_system_1_1_collections_1_1_array_list.html#a0ac362c523bd9da37ebd176c7725a276">System.Collections.ArrayList.Add</a></div><div class="ttdeci">virtual int Add(object value)</div><div class="ttdoc">Adds an object to the end of the T:System.Collections.ArrayList.</div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l02381">ArrayList.cs:2381</a></div></div>
<div class="ttc" id="namespace_system_html_a566c7365b77de53642aa0634953e1637a3c6e0b8a9c15224a8228b9a98ca1531d"><div class="ttname"><a href="namespace_system.html#a566c7365b77de53642aa0634953e1637a3c6e0b8a9c15224a8228b9a98ca1531d">System.ExceptionArgument.key</a></div></div>
<div class="ttc" id="namespace_system_html_a0a07336c131df63f71cf8d279bce526da34b6cd75171affba6957e308dcbd92be"><div class="ttname"><a href="namespace_system.html#a0a07336c131df63f71cf8d279bce526da34b6cd75171affba6957e308dcbd92be">System.ConfigNodeSubType.Version</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_code_group_html_a93cc42ed19b1c103362dd45b61eebeda"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_code_group.html#a93cc42ed19b1c103362dd45b61eebeda">System.Security.Policy.CodeGroup.PermissionSetName</a></div><div class="ttdeci">virtual string? PermissionSetName</div><div class="ttdoc">Gets the name of the named permission set for the code group.</div><div class="ttdef"><b>Definition:</b> <a href="_code_group_8cs_source.html#l00156">CodeGroup.cs:156</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_ac80702663cd363d0ca3e38a631513f8a"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ac80702663cd363d0ca3e38a631513f8a">System.Security.Policy.PolicyLevel.CreateAppDomainLevel</a></div><div class="ttdeci">static PolicyLevel CreateAppDomainLevel()</div><div class="ttdoc">Creates a new policy level for use at the application domain policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00304">PolicyLevel.cs:304</a></div></div>
<div class="ttc" id="class_system_1_1_argument_exception_html"><div class="ttname"><a href="class_system_1_1_argument_exception.html">System.ArgumentException</a></div><div class="ttdoc">The exception that is thrown when one of the arguments provided to a method is not valid.</div><div class="ttdef"><b>Definition:</b> <a href="_argument_exception_8cs_source.html#l00011">ArgumentException.cs:11</a></div></div>
<div class="ttc" id="class_system_1_1_i_o_1_1_file_stream_html_a043afb181ae153dee40036779a96e38e"><div class="ttname"><a href="class_system_1_1_i_o_1_1_file_stream.html#a043afb181ae153dee40036779a96e38e">System.IO.FileStream.Length</a></div><div class="ttdeci">override long Length</div><div class="ttdoc">Gets the length in bytes of the stream.</div><div class="ttdef"><b>Definition:</b> <a href="_file_stream_8cs_source.html#l00126">FileStream.cs:126</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a8b724f661a8e20d4f1caadf32b711c64"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a8b724f661a8e20d4f1caadf32b711c64">System.Security.Policy.PolicyLevel.RemoveNamedPermissionSet</a></div><div class="ttdeci">NamedPermissionSet RemoveNamedPermissionSet(string name)</div><div class="ttdoc">Removes the T:System.Security.NamedPermissionSet with the specified name from the current policy leve...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00460">PolicyLevel.cs:460</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_ab9d034affb2c37e91a2a567d9eee41f0"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ab9d034affb2c37e91a2a567d9eee41f0">System.Security.Policy.PolicyLevel.ToXml</a></div><div class="ttdeci">SecurityElement ToXml()</div><div class="ttdoc">Creates an XML encoding of the security object and its current state.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00618">PolicyLevel.cs:618</a></div></div>
<div class="ttc" id="namespace_system_1_1_collections_html"><div class="ttname"><a href="namespace_system_1_1_collections.html">System.Collections</a></div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l00007">ArrayList.cs:7</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_util_1_1_x_m_l_util_html_aa9fb98151b6592a6c58c2e5ded8b69ec"><div class="ttname"><a href="class_system_1_1_security_1_1_util_1_1_x_m_l_util.html#aa9fb98151b6592a6c58c2e5ded8b69ec">System.Security.Util.XMLUtil.CreateCodeGroup</a></div><div class="ttdeci">static CodeGroup CreateCodeGroup(SecurityElement el)</div><div class="ttdef"><b>Definition:</b> <a href="_x_m_l_util_8cs_source.html#l00275">XMLUtil.cs:275</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a95de9d8568442bf68b614256df0d77ee"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a95de9d8568442bf68b614256df0d77ee">System.Security.Policy.PolicyLevel.RemoveFullTrustAssembly</a></div><div class="ttdeci">void RemoveFullTrustAssembly(StrongName sn)</div><div class="ttdoc">Removes an assembly with the specified T:System.Security.Policy.StrongName from the list of assemblie...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00369">PolicyLevel.cs:369</a></div></div>
<div class="ttc" id="namespace_system_1_1_i_o_html_a482862b3c03fa32a3249d7904b91d586"><div class="ttname"><a href="namespace_system_1_1_i_o.html#a482862b3c03fa32a3249d7904b91d586">System.IO.FileAccess</a></div><div class="ttdeci">FileAccess</div><div class="ttdoc">Defines constants for read, write, or read/write access to a file.</div><div class="ttdef"><b>Definition:</b> <a href="_file_access_8cs_source.html#l00009">FileAccess.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_named_permission_set_html_a060f6cd3c7540bcc8bda9060fea422c5"><div class="ttname"><a href="class_system_1_1_security_1_1_named_permission_set.html#a060f6cd3c7540bcc8bda9060fea422c5">System.Security.NamedPermissionSet.Description</a></div><div class="ttdeci">string Description</div><div class="ttdoc">Gets or sets the text description of the current named permission set.</div><div class="ttdef"><b>Definition:</b> <a href="_named_permission_set_8cs_source.html#l00041">NamedPermissionSet.cs:41</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_evidence_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_evidence.html">System.Security.Policy.Evidence</a></div><div class="ttdoc">Defines the set of information that constitutes input to security policy decisions....</div><div class="ttdef"><b>Definition:</b> <a href="_evidence_8cs_source.html#l00017">Evidence.cs:17</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_dictionary_enumerator_html_a00ea809508fa82bfdb2c06f3cece42ee"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_dictionary_enumerator.html#a00ea809508fa82bfdb2c06f3cece42ee">System.Collections.IDictionaryEnumerator.Value</a></div><div class="ttdeci">object Value</div><div class="ttdoc">Gets the value of the current dictionary entry.</div><div class="ttdef"><b>Definition:</b> <a href="_i_dictionary_enumerator_8cs_source.html#l00025">IDictionaryEnumerator.cs:25</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_util_html"><div class="ttname"><a href="namespace_system_1_1_security_1_1_util.html">System.Security.Util</a></div><div class="ttdef"><b>Definition:</b> <a href="_config_8cs_source.html#l00005">Config.cs:5</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_security_element_html_ad48d7fbe45e318f8d33bcab6608fa812"><div class="ttname"><a href="class_system_1_1_security_1_1_security_element.html#ad48d7fbe45e318f8d33bcab6608fa812">System.Security.SecurityElement.AddAttribute</a></div><div class="ttdeci">void AddAttribute(string name, string value)</div><div class="ttdoc">Adds a name/value attribute to an XML element.</div><div class="ttdef"><b>Definition:</b> <a href="_security_element_8cs_source.html#l00326">SecurityElement.cs:326</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a033d21daeef4442029bf33fda54fac91"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a033d21daeef4442029bf33fda54fac91">System.Security.Policy.PolicyLevel.NamedPermissionSets</a></div><div class="ttdeci">IList NamedPermissionSets</div><div class="ttdoc">Gets a list of named permission sets defined for the policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00134">PolicyLevel.cs:134</a></div></div>
<div class="ttc" id="namespace_system_1_1_reflection_html_ada38d588af8789f8647e82c4b04f0cfca33909597338639745b2d76081beeb48b"><div class="ttname"><a href="namespace_system_1_1_reflection.html#ada38d588af8789f8647e82c4b04f0cfca33909597338639745b2d76081beeb48b">System.Reflection.TypeAttributes.Serializable</a></div><div class="ttdoc">Specifies that the class can be serialized.</div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a2d9998fd9bb3162cbf2f2d63db8829b5"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a2d9998fd9bb3162cbf2f2d63db8829b5">System.Security.Policy.PolicyLevel.AddNamedPermissionSet</a></div><div class="ttdeci">void AddNamedPermissionSet(NamedPermissionSet permSet)</div><div class="ttdoc">Adds a T:System.Security.NamedPermissionSet to the current policy level.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00416">PolicyLevel.cs:416</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_dictionary_enumerator_html"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_dictionary_enumerator.html">System.Collections.IDictionaryEnumerator</a></div><div class="ttdoc">Enumerates the elements of a nongeneric dictionary.</div><div class="ttdef"><b>Definition:</b> <a href="_i_dictionary_enumerator_8cs_source.html#l00008">IDictionaryEnumerator.cs:8</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_security_element_html_ad24193db4883540cf336dcec27d9aea2"><div class="ttname"><a href="class_system_1_1_security_1_1_security_element.html#ad24193db4883540cf336dcec27d9aea2">System.Security.SecurityElement.Children</a></div><div class="ttdeci">ArrayList Children</div><div class="ttdoc">Gets or sets the array of child elements of the XML element.</div><div class="ttdef"><b>Definition:</b> <a href="_security_element_8cs_source.html#l00177">SecurityElement.cs:177</a></div></div>
<div class="ttc" id="class_system_1_1_text_1_1_encoding_html_a512fe96ac1087a83ef66007170c7769f"><div class="ttname"><a href="class_system_1_1_text_1_1_encoding.html#a512fe96ac1087a83ef66007170c7769f">System.Text.Encoding.UTF8</a></div><div class="ttdeci">static Encoding UTF8</div><div class="ttdoc">Gets an encoding for the UTF-8 format.</div><div class="ttdef"><b>Definition:</b> <a href="_encoding_8cs_source.html#l01023">Encoding.cs:1023</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_array_list_html_a47d0997c287eb355e07553ec1de1fd0a"><div class="ttname"><a href="class_system_1_1_collections_1_1_array_list.html#a47d0997c287eb355e07553ec1de1fd0a">System.Collections.ArrayList.GetEnumerator</a></div><div class="ttdeci">virtual IEnumerator GetEnumerator()</div><div class="ttdoc">Returns an enumerator for the entire T:System.Collections.ArrayList.</div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l02615">ArrayList.cs:2615</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_util_1_1_x_m_l_util_html"><div class="ttname"><a href="class_system_1_1_security_1_1_util_1_1_x_m_l_util.html">System.Security.Util.XMLUtil</a></div><div class="ttdef"><b>Definition:</b> <a href="_x_m_l_util_8cs_source.html#l00009">XMLUtil.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_i_o_1_1_file_html"><div class="ttname"><a href="class_system_1_1_i_o_1_1_file.html">System.IO.File</a></div><div class="ttdoc">Provides static methods for the creation, copying, deletion, moving, and opening of a single file,...</div><div class="ttdef"><b>Definition:</b> <a href="_file_8cs_source.html#l00014">File.cs:14</a></div></div>
<div class="ttc" id="class_system_1_1_type_html_a4f53518d4bf1282dc89372c425c07d6f"><div class="ttname"><a href="class_system_1_1_type.html#a4f53518d4bf1282dc89372c425c07d6f">System.Type.GetType</a></div><div class="ttdeci">static Type GetType(string typeName, bool throwOnError, bool ignoreCase)</div><div class="ttdoc">Gets the T:System.Type with the specified name, specifying whether to throw an exception if the type ...</div><div class="ttdef"><b>Definition:</b> <a href="_type_8cs_source.html#l00853">Type.cs:853</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_policy_html_ad38c269e2749eeacc5996f4840cd807ba6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="namespace_system_1_1_security_1_1_policy.html#ad38c269e2749eeacc5996f4840cd807ba6adf97f83acf6453d4a6a4b1070f3754">System.Security.Policy.ConfigId.None</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a399b1c4700ed1f9ab0c8089931bcc211"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a399b1c4700ed1f9ab0c8089931bcc211">System.Security.Policy.PolicyLevel.FullTrustAssemblies</a></div><div class="ttdeci">IList FullTrustAssemblies</div><div class="ttdoc">Gets a list of T:System.Security.Policy.StrongNameMembershipCondition objects used to determine wheth...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00154">PolicyLevel.cs:154</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_aca2cbb087803debaba70a7e1c7710967"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#aca2cbb087803debaba70a7e1c7710967">System.Security.Policy.PolicyLevel.GetNamedPermissionSet</a></div><div class="ttdeci">NamedPermissionSet GetNamedPermissionSet(string name)</div><div class="ttdoc">Returns the T:System.Security.NamedPermissionSet in the current policy level with the specified name.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00561">PolicyLevel.cs:561</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_permissions_html"><div class="ttname"><a href="namespace_system_1_1_security_1_1_permissions.html">System.Security.Permissions</a></div><div class="ttdef"><b>Definition:</b> <a href="_built_in_permission_flag_8cs_source.html#l00001">BuiltInPermissionFlag.cs:1</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_permissions_html_a72a0c66eedeb26a4e728464bf13ec46e"><div class="ttname"><a href="namespace_system_1_1_security_1_1_permissions.html#a72a0c66eedeb26a4e728464bf13ec46e">System.Security.Permissions.SecurityPermissionFlag</a></div><div class="ttdeci">SecurityPermissionFlag</div><div class="ttdoc">Specifies access flags for the security permission object.</div><div class="ttdef"><b>Definition:</b> <a href="_security_permission_flag_8cs_source.html#l00009">SecurityPermissionFlag.cs:9</a></div></div>
<div class="ttc" id="namespace_system_1_1_security_1_1_policy_html"><div class="ttname"><a href="namespace_system_1_1_security_1_1_policy.html">System.Security.Policy</a></div><div class="ttdef"><b>Definition:</b> <a href="_all_membership_condition_8cs_source.html#l00004">AllMembershipCondition.cs:4</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_af2d073f18651959c8a45246596ee497f"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af2d073f18651959c8a45246596ee497f">System.Security.Policy.PolicyLevel.RemoveFullTrustAssembly</a></div><div class="ttdeci">void RemoveFullTrustAssembly(StrongNameMembershipCondition snMC)</div><div class="ttdoc">Removes an assembly with the specified T:System.Security.Policy.StrongNameMembershipCondition from th...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00384">PolicyLevel.cs:384</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_ad70e34e5aebdd445f51e1e6d480832ff"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ad70e34e5aebdd445f51e1e6d480832ff">System.Security.Policy.PolicyLevel.Recover</a></div><div class="ttdeci">void Recover()</div><div class="ttdoc">Replaces the configuration file for this T:System.Security.Policy.PolicyLevel with the last backup (r...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00578">PolicyLevel.cs:578</a></div></div>
<div class="ttc" id="class_system_1_1_threading_1_1_interlocked_html"><div class="ttname"><a href="class_system_1_1_threading_1_1_interlocked.html">System.Threading.Interlocked</a></div><div class="ttdoc">Provides atomic operations for variables that are shared by multiple threads.</div><div class="ttdef"><b>Definition:</b> <a href="_interlocked_8cs_source.html#l00010">Interlocked.cs:10</a></div></div>
<div class="ttc" id="namespace_system_1_1_threading_html"><div class="ttname"><a href="namespace_system_1_1_threading.html">System.Threading</a></div><div class="ttdef"><b>Definition:</b> <a href="___i_o_completion_callback_8cs_source.html#l00003">_IOCompletionCallback.cs:3</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_exception_html"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_exception.html">System.Security.Policy.PolicyException</a></div><div class="ttdoc">The exception that is thrown when policy forbids code to run.</div><div class="ttdef"><b>Definition:</b> <a href="_policy_exception_8cs_source.html#l00009">PolicyException.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_ad21d8492577ca10bfcceeacf743a99ce"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#ad21d8492577ca10bfcceeacf743a99ce">System.Security.Policy.PolicyLevel.ResolveMatchingCodeGroups</a></div><div class="ttdeci">CodeGroup ResolveMatchingCodeGroups(Evidence evidence)</div><div class="ttdoc">Resolves policy at the policy level and returns the root of a code group tree that matches the eviden...</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00314">PolicyLevel.cs:314</a></div></div>
<div class="ttc" id="interface_system_1_1_collections_1_1_i_enumerator_html"><div class="ttname"><a href="interface_system_1_1_collections_1_1_i_enumerator.html">System.Collections.IEnumerator</a></div><div class="ttdoc">Supports a simple iteration over a non-generic collection.</div><div class="ttdef"><b>Definition:</b> <a href="_system_8_collections_2_i_enumerator_8cs_source.html#l00009">IEnumerator.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_i_o_1_1_path_html"><div class="ttname"><a href="class_system_1_1_i_o_1_1_path.html">System.IO.Path</a></div><div class="ttdoc">Performs operations on T:System.String instances that contain file or directory path information....</div><div class="ttdef"><b>Definition:</b> <a href="_path_8cs_source.html#l00013">Path.cs:13</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_af12ba222b31f98e0e92f94e04b105252"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#af12ba222b31f98e0e92f94e04b105252">System.Security.Policy.PolicyLevel.Resolve</a></div><div class="ttdeci">PolicyStatement Resolve(Evidence evidence)</div><div class="ttdoc">Resolves policy based on evidence for the policy level, and returns the resulting T:System....</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00610">PolicyLevel.cs:610</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_strong_name_html_a3710d8ae95a33b4a99b81f7b8af14062"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_strong_name.html#a3710d8ae95a33b4a99b81f7b8af14062">System.Security.Policy.StrongName.Name</a></div><div class="ttdeci">string Name</div><div class="ttdoc">Gets the simple name of the current T:System.Security.Policy.StrongName.</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_8cs_source.html#l00032">StrongName.cs:32</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob_html"><div class="ttname"><a href="class_system_1_1_security_1_1_permissions_1_1_strong_name_public_key_blob.html">System.Security.Permissions.StrongNamePublicKeyBlob</a></div><div class="ttdoc">Represents the public key information (called a blob) for a strong name. This class cannot be inherit...</div><div class="ttdef"><b>Definition:</b> <a href="_strong_name_public_key_blob_8cs_source.html#l00009">StrongNamePublicKeyBlob.cs:9</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_policy_1_1_policy_level_html_a48b602fd5efbc171aaa3867cf124b9b9"><div class="ttname"><a href="class_system_1_1_security_1_1_policy_1_1_policy_level.html#a48b602fd5efbc171aaa3867cf124b9b9">System.Security.Policy.PolicyLevel.AddFullTrustAssembly</a></div><div class="ttdeci">void AddFullTrustAssembly(StrongNameMembershipCondition snMC)</div><div class="ttdoc">Adds the specified T:System.Security.Policy.StrongNameMembershipCondition to the list of T:System....</div><div class="ttdef"><b>Definition:</b> <a href="_policy_level_8cs_source.html#l00343">PolicyLevel.cs:343</a></div></div>
<div class="ttc" id="class_system_1_1_security_1_1_util_1_1_config_html"><div class="ttname"><a href="class_system_1_1_security_1_1_util_1_1_config.html">System.Security.Util.Config</a></div><div class="ttdef"><b>Definition:</b> <a href="_config_8cs_source.html#l00007">Config.cs:7</a></div></div>
<div class="ttc" id="class_system_1_1_collections_1_1_array_list_html"><div class="ttname"><a href="class_system_1_1_collections_1_1_array_list.html">System.Collections.ArrayList</a></div><div class="ttdoc">Implements the T:System.Collections.IList interface using an array whose size is dynamically increase...</div><div class="ttdef"><b>Definition:</b> <a href="_array_list_8cs_source.html#l00014">ArrayList.cs:14</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a6812baae362b4b0e5ef28a521c5bec4.html">System.Security.Policy</a></li><li class="navelem"><a class="el" href="_policy_level_8cs.html">PolicyLevel.cs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
